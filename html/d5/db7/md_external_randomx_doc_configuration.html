<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Monero: RandomX configuration</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Monero
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">RandomX configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>RandomX has 45 customizable parameters (see table below). We recommend each project using RandomX to select a unique configuration to prevent network attacks from hashpower rental services.</p>
<p>These parameters can be modified in source file <a href="../../../src/configuration.h">configuration.h</a>.</p>
<table class="doxtable">
<tr>
<th>parameter</th><th>description</th><th>default value  </th></tr>
<tr>
<td><code>RANDOMX_ARGON_MEMORY</code></td><td>The number of 1 KiB Argon2 blocks in the Cache</td><td><code>262144</code> </td></tr>
<tr>
<td><code>RANDOMX_ARGON_ITERATIONS</code></td><td>The number of Argon2d iterations for Cache initialization</td><td><code>3</code> </td></tr>
<tr>
<td><code>RANDOMX_ARGON_LANES</code></td><td>The number of parallel lanes for Cache initialization</td><td><code>1</code> </td></tr>
<tr>
<td><code>RANDOMX_ARGON_SALT</code></td><td>Argon2 salt</td><td><code>"RandomX\x03"</code> </td></tr>
<tr>
<td><code>RANDOMX_CACHE_ACCESSES</code></td><td>The number of random Cache accesses per Dataset item</td><td><code>8</code> </td></tr>
<tr>
<td><code>RANDOMX_SUPERSCALAR_LATENCY</code></td><td>Target latency for SuperscalarHash (in cycles of the reference CPU)</td><td><code>170</code> </td></tr>
<tr>
<td><code>RANDOMX_DATASET_BASE_SIZE</code></td><td>Dataset base size in bytes</td><td><code>2147483648</code> </td></tr>
<tr>
<td><code>RANDOMX_DATASET_EXTRA_SIZE</code></td><td>Dataset extra size in bytes</td><td><code>33554368</code> </td></tr>
<tr>
<td><code>RANDOMX_PROGRAM_SIZE</code></td><td>The number of instructions in a RandomX program</td><td><code>256</code> </td></tr>
<tr>
<td><code>RANDOMX_PROGRAM_ITERATIONS</code></td><td>The number of iterations per program</td><td><code>2048</code> </td></tr>
<tr>
<td><code>RANDOMX_PROGRAM_COUNT</code></td><td>The number of programs per hash</td><td><code>8</code> </td></tr>
<tr>
<td><code>RANDOMX_JUMP_BITS</code></td><td>Jump condition mask size in bits</td><td><code>8</code> </td></tr>
<tr>
<td><code>RANDOMX_JUMP_OFFSET</code></td><td>Jump condition mask offset in bits</td><td><code>8</code> </td></tr>
<tr>
<td><code>RANDOMX_SCRATCHPAD_L3</code></td><td>Scratchpad size in bytes</td><td><code>2097152</code> </td></tr>
<tr>
<td><code>RANDOMX_SCRATCHPAD_L2</code></td><td>Scratchpad L2 size in bytes</td><td><code>262144</code> </td></tr>
<tr>
<td><code>RANDOMX_SCRATCHPAD_L1</code></td><td>Scratchpad L1 size in bytes</td><td><code>16384</code> </td></tr>
<tr>
<td><code>RANDOMX_FREQ_*</code> (29x)</td><td>Instruction frequencies</td><td>multiple values </td></tr>
</table>
<p>Not all of the parameters can be changed safely and most parameters have some contraints on what values can be selected (checked at compile-time).</p>
<p><b>Disclaimer: The compile-time checks only prevent obviously broken configurations. Passing the checks does not imply that the configuration is safe and will not cause crashes or other issues. We recommend that each non-standard configuration is thoroughly tested before being deployed.</b></p>
<h3>RANDOMX_ARGON_MEMORY</h3>
<p>This parameter determines the amount of memory needed in the light mode. Memory is specified in KiB (1 KiB = 1024 bytes).</p>
<h4>Permitted values</h4>
<p>Integer powers of 2 in the range 8 - 2097152.</p>
<h4>Notes</h4>
<p>Lower sizes will reduce the memory-hardness of the algorithm.</p>
<h3>RANDOMX_ARGON_ITERATIONS</h3>
<p>Determines the number of passes of Argon2 that are used to generate the Cache.</p>
<h4>Permitted values</h4>
<p>Any positive 32-bit integer.</p>
<h4>Notes</h4>
<p>The time needed to initialize the Cache is proportional to the value of this constant.</p>
<h3>RANDOMX_ARGON_LANES</h3>
<p>The number of parallel lanes for Cache initialization.</p>
<h4>Permitted values</h4>
<p>Integers in the range 1 - 16777215.</p>
<h4>Notes</h4>
<p>This parameter determines how many threads can be used for Cache initialization.</p>
<h3>RANDOMX_ARGON_SALT</h3>
<p>Salt value for Cache initialization.</p>
<h4>Permitted values</h4>
<p>A string of at least 8 characters.</p>
<h4>Note</h4>
<p>Every implementation should choose a unique salt value.</p>
<h3>RANDOMX_CACHE_ACCESSES</h3>
<p>The number of random Cache access per Dataset item.</p>
<h4>Permitted values</h4>
<p>Any integer greater than 1.</p>
<h4>Notes</h4>
<p>This value directly determines the performance ratio between the 'fast' and 'light' modes.</p>
<h3>RANDOMX_SUPERSCALAR_LATENCY</h3>
<p>Target latency for SuperscalarHash, in cycles of the reference CPU.</p>
<h4>Permitted values</h4>
<p>Integers in the range 1 - 10000.</p>
<h4>Notes</h4>
<p>The default value was tuned so that a high-performance superscalar CPU running at 2-4 GHz will execute SuperscalarHash in similar time it takes to load data from RAM (40-80 ns). Using a lower value will make Dataset generation (and light mode) more memory bound, while increasing this value will make Dataset generation (and light mode) more compute bound.</p>
<h3>RANDOMX_DATASET_BASE_SIZE</h3>
<p>Dataset base size in bytes.</p>
<h4>Permitted values</h4>
<p>Integer powers of 2 in the range 64 - 4294967296 (inclusive).</p>
<h4>Note</h4>
<p>This constant affects the memory requirements in fast mode. Some values are unsafe depending on other parameters. See <a href="../../#unsafe-configurations">Unsafe configurations</a>.</p>
<h3>RANDOMX_DATASET_EXTRA_SIZE</h3>
<p>Dataset extra size in bytes.</p>
<h4>Permitted values</h4>
<p>Non-negative integer divisible by 64.</p>
<h4>Note</h4>
<p>This constant affects the memory requirements in fast mode. Some values are unsafe depending on other parameters. See <a href="../../#unsafe-configurations">Unsafe configurations</a>.</p>
<h3>RANDOMX_PROGRAM_SIZE</h3>
<p>The number of instructions in a RandomX program.</p>
<h4>Permitted values</h4>
<p>Positive integers divisible by 8 in the range 8 - 32768 (inclusive).</p>
<h4>Notes</h4>
<p>Smaller values will make RandomX more DRAM-latency bound, while higher values will make RandomX more compute-bound. Some values are unsafe. See <a href="../../#unsafe-configurations">Unsafe configurations</a>.</p>
<h3>RANDOMX_PROGRAM_ITERATIONS</h3>
<p>The number of iterations per program.</p>
<h4>Permitted values</h4>
<p>Any positive integer.</p>
<h4>Notes</h4>
<p>Time per hash increases linearly with this constant. Smaller values will increase the overhead of program compilation, while larger values may allow more time for optimizations. Some values are unsafe. See <a href="../../#unsafe-configurations">Unsafe configurations</a>.</p>
<h3>RANDOMX_PROGRAM_COUNT</h3>
<p>The number of programs per hash.</p>
<h4>Permitted values</h4>
<p>Any positive integer.</p>
<h4>Notes</h4>
<p>Time per hash increases linearly with this constant. Some values are unsafe. See <a href="../../#unsafe-configurations">Unsafe configurations</a>.</p>
<h3>RANDOMX_JUMP_BITS</h3>
<p>Jump condition mask size in bits.</p>
<h4>Permitted values</h4>
<p>Positive integers. The sum of <code>RANDOMX_JUMP_BITS</code> and <code>RANDOMX_JUMP_OFFSET</code> must not exceed 16.</p>
<h4>Notes</h4>
<p>This determines the jump probability of the CBRANCH instruction. The default value of 8 results in jump probability of <code>1/2<sup>8</sup> = 1/256</code>. Increasing this constant will decrease the rate of jumps (and vice versa).</p>
<h3>RANDOMX_JUMP_OFFSET</h3>
<p>Jump condition mask offset in bits.</p>
<h4>Permitted values</h4>
<p>Non-negative integers. The sum of <code>RANDOMX_JUMP_BITS</code> and <code>RANDOMX_JUMP_OFFSET</code> must not exceed 16.</p>
<h4>Notes</h4>
<p>Since the low-order bits of RandomX registers are slightly biased, this offset moves the condition mask to higher bits, which are less biased. Using values smaller than the default may result in a slightly lower jump probability than the theoretical value calculated from <code>RANDOMX_JUMP_BITS</code>.</p>
<h3>RANDOMX_SCRATCHPAD_L3</h3>
<p>RandomX Scratchpad size in bytes.</p>
<h4>Permitted values</h4>
<p>Any integer power of 2. Must be larger than or equal to <code>RANDOMX_SCRATCHPAD_L2</code>.</p>
<h4>Notes</h4>
<p>The default value of 2 MiB was selected to match the typical cache/core ratio of desktop processors. Using a lower value will make RandomX more core-bound, while using larger values will make the algorithm more latency-bound. Some values are unsafe depending on other parameters. See <a href="../../#unsafe-configurations">Unsafe configurations</a>.</p>
<h3>RANDOMX_SCRATCHPAD_L2</h3>
<p>Scratchpad L2 size in bytes.</p>
<h4>Permitted values</h4>
<p>Any integer power of 2. Must be larger than or equal to <code>RANDOMX_SCRATCHPAD_L1</code>.</p>
<h4>Notes</h4>
<p>The default value of 256 KiB was selected to match the typical per-core L2 cache size of desktop processors. Using a lower value will make RandomX more core-bound, while using larger values will make the algorithm more latency-bound.</p>
<h3>RANDOMX_SCRATCHPAD_L1</h3>
<p>Scratchpad L1 size in bytes.</p>
<h4>Permitted values</h4>
<p>Any integer power of 2. The minimum is 64 bytes.</p>
<h4>Notes</h4>
<p>The default value of 16 KiB was selected to be about half of the per-core L1 cache size of desktop processors. Using a lower value will make RandomX more core-bound, while using larger values will make the algorithm more latency-bound.</p>
<h3>RANDOMX_FREQ_*</h3>
<p>Instruction frequencies (per 256 instructions).</p>
<h4>Permitted values</h4>
<p>There is a total of 29 different instructions. The sum of frequencies must be equal to 256.</p>
<h4>Notes</h4>
<p>Making changes to the default values is not recommended. The only exceptions are the instruction pairs IROR_R/IROL_R, FADD_R/FSUB_R and FADD_M/FSUB_M, which are functionally equivalent. Example of a safe custom configuration:</p>
<p>||default|custom| |-|---&mdash;|---&mdash;|-| |<code>RANDOMX_FREQ_IROR_R</code>|8|5| |<code>RANDOMX_FREQ_IROL_R</code>|2|5|</p>
<table class="doxtable">
<tr>
<th></th><th>default</th><th>custom  </th></tr>
<tr>
<td><code>RANDOMX_FREQ_FADD_R</code></td><td>16</td><td>17 </td></tr>
<tr>
<td><code>RANDOMX_FREQ_FSUB_R</code></td><td>16</td><td>15 </td></tr>
</table>
<table class="doxtable">
<tr>
<th></th><th>default</th><th>custom  </th></tr>
<tr>
<td><code>RANDOMX_FREQ_FADD_M</code></td><td>5</td><td>4 </td></tr>
<tr>
<td><code>RANDOMX_FREQ_FSUB_M</code></td><td>5</td><td>6 </td></tr>
</table>
<h2>Unsafe configurations</h2>
<p>There are some configurations that are considered 'unsafe' because they affect the security of the algorithm against attacks. If the conditions listed below are not satisfied, the configuration is unsafe and a compilation error is emitted when building the RandomX library.</p>
<p>These checks can be disabled by definining <code>RANDOMX_UNSAFE</code> when building RandomX, e.g. by using <code>-DRANDOMX_UNSAFE</code> command line switch in GCC or MSVC. It is not recommended to disable these checks except for testing purposes.</p>
<h3>1. Memory-time tradeoffs</h3>
<p>#### Condition </p><div class="fragment"><div class="line">RANDOMX_CACHE_ACCESSES * RANDOMX_ARGON_MEMORY * 1024 + 33554432 &gt;= RANDOMX_DATASET_BASE_SIZE + RANDOMX_DATASET_EXTRA_SIZE</div></div><!-- fragment --><p>Configurations not satisfying this condition are vulnerable to memory-time tradeoffs, which enables efficient mining in light mode.</p>
<h4>Solutions</h4>
<ul>
<li>Increase <code>RANDOMX_CACHE_ACCESSES</code> or <code>RANDOMX_ARGON_MEMORY</code>.</li>
<li>Decrease <code>RANDOMX_DATASET_BASE_SIZE</code> or <code>RANDOMX_DATASET_EXTRA_SIZE</code>.</li>
</ul>
<h3>2. Insufficient Scratchpad writes</h3>
<p>#### Condition </p><div class="fragment"><div class="line">(128 + RANDOMX_PROGRAM_SIZE * RANDOMX_FREQ_ISTORE / 256) * (RANDOMX_PROGRAM_COUNT * RANDOMX_PROGRAM_ITERATIONS) &gt;= RANDOMX_SCRATCHPAD_L3</div></div><!-- fragment --><p>Configurations not satisfying this condition are vulnerable to Scratchpad size optimizations due to low amount of writes.</p>
<h4>Solutions</h4>
<ul>
<li>Increase <code>RANDOMX_PROGRAM_SIZE</code>, <code>RANDOMX_FREQ_ISTORE</code>, <code>RANDOMX_PROGRAM_COUNT</code> or <code>RANDOMX_PROGRAM_ITERATIONS</code>.</li>
<li>Decrease <code>RANDOMX_SCRATCHPAD_L3</code>.</li>
</ul>
<h3>3. Program filtering strategies</h3>
<p>#### Condition </p><div class="fragment"><div class="line">RANDOMX_PROGRAM_COUNT &gt; 1</div></div><!-- fragment --><p>Configurations not satisfying this condition are vulnerable to program filtering strategies.</p>
<h4>Solution</h4>
<ul>
<li>Increase <code>RANDOMX_PROGRAM_COUNT</code> to at least 2.</li>
</ul>
<h3>4. Low program entropy</h3>
<p>#### Condition </p><div class="fragment"><div class="line">RANDOMX_PROGRAM_SIZE &gt;= 64</div></div><!-- fragment --><p>Configurations not satisfying this condition do not have a sufficient number of instruction combinations.</p>
<h4>Solution</h4>
<ul>
<li>Increase <code>RANDOMX_PROGRAM_SIZE</code> to at least 64.</li>
</ul>
<h3>5. High compilation overhead</h3>
<p>#### Condition </p><div class="fragment"><div class="line">RANDOMX_PROGRAM_ITERATIONS &gt;= 400</div></div><!-- fragment --><p>Configurations not satisfying this condition have a program compilation overhead exceeding 10%.</p>
<h4>Solution</h4>
<ul>
<li>Increase <code>RANDOMX_PROGRAM_ITERATIONS</code> to at least 400. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Sep 2 2023 19:23:33 for Monero by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
