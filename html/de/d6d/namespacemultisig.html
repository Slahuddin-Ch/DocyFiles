<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Monero: multisig Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Monero
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">multisig Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:d8/d08/namespacemultisig_1_1signing"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d08/namespacemultisig_1_1signing.html">signing</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d41/classmultisig_1_1Guard.html">Guard</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbc/classmultisig_1_1multisig__account.html">multisig_account</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/da2/structmultisig_1_1multisig__kex__msg__serializable__general.html">multisig_kex_msg_serializable_general</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">general kex message (if round &gt; 1)  <a href="../../d2/da2/structmultisig_1_1multisig__kex__msg__serializable__general.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d3e/structmultisig_1_1multisig__kex__msg__serializable__round1.html">multisig_kex_msg_serializable_round1</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">round 1 kex message  <a href="../../de/d3e/structmultisig_1_1multisig__kex__msg__serializable__round1.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d66/classmultisig_1_1MultisigTest.html">MultisigTest</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a8cd9bc62682a68aa4b8eab48774d21f2"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> = std::unordered_map&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a73b9f16c3fec8b0bfab2c7789414e766">crypto::public_key_memsafe</a>, std::unordered_set&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &gt;</td></tr>
<tr class="separator:a8cd9bc62682a68aa4b8eab48774d21f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae28f1a7222fe6e8a5f7e71e9a6133cf5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#ae28f1a7222fe6e8a5f7e71e9a6133cf5">get_multisig_blinded_secret_key</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;<a class="el" href="../../df/d8f/hmac__keccak_8cpp.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>)</td></tr>
<tr class="memdesc:ae28f1a7222fe6e8a5f7e71e9a6133cf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_multisig_blinded_secret_key - converts an input private key into a blinded multisig private key Use 1a: converts account private spend key into multisig private key, which is used for key exchange and message signing Use 1b: converts account private view key into ancillary private key share, for the composite multisig private view key Use 2: converts DH shared secrets (curve points) into private keys, which are intermediate private keys in multisig key exchange  <a href="#ae28f1a7222fe6e8a5f7e71e9a6133cf5">More...</a><br /></td></tr>
<tr class="separator:ae28f1a7222fe6e8a5f7e71e9a6133cf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a732092cc9a0b0c4068e60ab31446a984"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a732092cc9a0b0c4068e60ab31446a984">generate_multisig_key_image</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/dfd/structcryptonote_1_1account__keys.html">cryptonote::account_keys</a> &amp;keys, std::size_t multisig_key_index, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;out_key, <a class="el" href="../../de/d36/namespacecrypto.html#aa037f5696319eb94e5e7bf3210665af0">crypto::key_image</a> &amp;ki)</td></tr>
<tr class="separator:a732092cc9a0b0c4068e60ab31446a984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92b5989e46ab85aafd7ceb21e6735ad6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a92b5989e46ab85aafd7ceb21e6735ad6">generate_multisig_LR</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> pkey, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;k, <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;<a class="el" href="../../d6/ddf/jh_8c.html#a90d5704063a6391e6c463cc9d308ac8f">L</a>, <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;R)</td></tr>
<tr class="separator:a92b5989e46ab85aafd7ceb21e6735ad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007f838abcebaff04b9420518cfc8ad1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a007f838abcebaff04b9420518cfc8ad1">generate_multisig_composite_key_image</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/dfd/structcryptonote_1_1account__keys.html">cryptonote::account_keys</a> &amp;keys, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::unordered_map&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a>, <a class="el" href="../../d0/dad/structcryptonote_1_1subaddress__index.html">cryptonote::subaddress_index</a> &gt; &amp;subaddresses, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;out_key, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;tx_public_key, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;additional_tx_public_keys, std::size_t real_output_index, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#aa037f5696319eb94e5e7bf3210665af0">crypto::key_image</a> &gt; &amp;pkis, <a class="el" href="../../de/d36/namespacecrypto.html#aa037f5696319eb94e5e7bf3210665af0">crypto::key_image</a> &amp;ki)</td></tr>
<tr class="separator:a007f838abcebaff04b9420518cfc8ad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24dd169089cafe99a971bf8b2a81bee9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a24dd169089cafe99a971bf8b2a81bee9">multisig_kex_rounds_required</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> num_signers, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> threshold)</td></tr>
<tr class="separator:a24dd169089cafe99a971bf8b2a81bee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36b1fb3d73726b41ba8c506eb1d519fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a36b1fb3d73726b41ba8c506eb1d519fc">multisig_setup_rounds_required</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> num_signers, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> threshold)</td></tr>
<tr class="separator:a36b1fb3d73726b41ba8c506eb1d519fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a767371405f256e64d7df80aec9f49537"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a767371405f256e64d7df80aec9f49537">check_multisig_config</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> <a class="el" href="../../d0/d32/aesb_8c.html#aca9f6c90dc08553c6d90f6f0d2c85dce">round</a>, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> threshold, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> num_signers)</td></tr>
<tr class="separator:a767371405f256e64d7df80aec9f49537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedc02ee5adda4e01e2369eee64342610"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#aedc02ee5adda4e01e2369eee64342610">calculate_multisig_keypair_from_derivation</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a73b9f16c3fec8b0bfab2c7789414e766">crypto::public_key_memsafe</a> &amp;derivation, <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;derived_pubkey_out)</td></tr>
<tr class="separator:aedc02ee5adda4e01e2369eee64342610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04f03bb373370ed7b622414bb3faff1e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a04f03bb373370ed7b622414bb3faff1e">make_multisig_common_privkey</a> (std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &gt; participant_base_common_privkeys, <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;common_privkey_out)</td></tr>
<tr class="separator:a04f03bb373370ed7b622414bb3faff1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a266839b14c87a18a860d8c5fa4b4ca1d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../df/dbc/structrct_1_1key.html">rct::key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a266839b14c87a18a860d8c5fa4b4ca1d">compute_multisig_aggregation_coefficient</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;sorted_keys, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;aggregation_key)</td></tr>
<tr class="separator:a266839b14c87a18a860d8c5fa4b4ca1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf88908b3440dbc902605f68a886492d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#acf88908b3440dbc902605f68a886492d">generate_multisig_aggregate_key</a> (std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; final_keys, std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &gt; &amp;privkeys_inout)</td></tr>
<tr class="separator:acf88908b3440dbc902605f68a886492d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47fe1e8dcd42b241cbaf950917625168"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a47fe1e8dcd42b241cbaf950917625168">multisig_kex_make_round_keys</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;base_privkey, <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> pubkey_origins_map, <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> &amp;derivation_origins_map_out)</td></tr>
<tr class="separator:a47fe1e8dcd42b241cbaf950917625168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a406dd972934b2cb71f210760bc93e440"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a406dd972934b2cb71f210760bc93e440">check_messages_round</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;expanded_msgs, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> expected_round)</td></tr>
<tr class="separator:a406dd972934b2cb71f210760bc93e440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a56d8fe02530ed4d84ec1e0746a7c97"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a5a56d8fe02530ed4d84ec1e0746a7c97">multisig_kex_msgs_sanitize_pubkeys</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;expanded_msgs, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;exclude_pubkeys, <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> &amp;sanitized_pubkeys_out)</td></tr>
<tr class="separator:a5a56d8fe02530ed4d84ec1e0746a7c97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9381bc6a9e3cfd995fb4e989e12a571e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a9381bc6a9e3cfd995fb4e989e12a571e">remove_key_from_mapped_sets</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;key_to_remove, <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> &amp;keyset_inout)</td></tr>
<tr class="separator:a9381bc6a9e3cfd995fb4e989e12a571e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bec541f53feb3e2a5ab08f34c4230c3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a4bec541f53feb3e2a5ab08f34c4230c3">evaluate_multisig_kex_round_msgs</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;base_pubkey, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> expected_round, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;signers, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;expanded_msgs, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;exclude_pubkeys, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a> incomplete_signer_set)</td></tr>
<tr class="separator:a4bec541f53feb3e2a5ab08f34c4230c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a340de528aaea59499f0465d98643c4bc"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a340de528aaea59499f0465d98643c4bc">evaluate_multisig_post_kex_round_msgs</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;base_pubkey, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> expected_round, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;signers, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;expanded_msgs, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a> incomplete_signer_set)</td></tr>
<tr class="separator:a340de528aaea59499f0465d98643c4bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc202f0201f3c63406e9b35b46c678e5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#abc202f0201f3c63406e9b35b46c678e5">multisig_kex_process_round_msgs</a> (<a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;base_privkey, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;base_pubkey, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> current_round, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> threshold, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;signers, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;expanded_msgs, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;exclude_pubkeys, <a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a> incomplete_signer_set, <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> &amp;keys_to_origins_map_out)</td></tr>
<tr class="separator:abc202f0201f3c63406e9b35b46c678e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0ff090816e005304fd727ba22e18d290"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d6d/namespacemultisig.html#a0ff090816e005304fd727ba22e18d290">MULTISIG_PUB_ADDRS</a></td></tr>
<tr class="separator:a0ff090816e005304fd727ba22e18d290"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a8cd9bc62682a68aa4b8eab48774d21f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cd9bc62682a68aa4b8eab48774d21f2">&#9670;&nbsp;</a></span>multisig_keyset_map_memsafe_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig::multisig_keyset_map_memsafe_t</a> = typedef std::unordered_map&lt;<a class="el" href="../../de/d36/namespacecrypto.html#a73b9f16c3fec8b0bfab2c7789414e766">crypto::public_key_memsafe</a>, std::unordered_set&lt;<a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a>&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>multisig account:</p>
<ul>
<li>handles account keys for an M-of-N multisig participant (M &lt;= N; M &gt;= 1; N &gt;= 2)</li>
<li>encapsulates multisig account construction process (via key exchange [kex])</li>
<li>TODO: encapsulates key preparation for aggregation-style signing</li>
</ul>
<p>:: multisig pubkey: the private key is split, M group participants are required to reassemble (e.g. to sign something)</p><ul>
<li>in cryptonote, this is the multisig spend key :: multisig common pubkey: the private key is known to all participants (e.g. for authenticating as a group member)</li>
<li>in cryptonote, this is the multisig view key</li>
</ul>
<p>multisig key exchange:</p>
<p>An 'M-of-N' (M &lt;= N; M &gt;= 1; N &gt;= 2) multisignature key is a public key where at least 'M' out of 'N' possible co-signers must collaborate in order to create a signature.</p>
<p>Constructing a multisig key involves a series of Diffie-Hellman exchanges between participants. At the end of key exchange (kex), each participant will hold a number of private keys. Each private key is shared by a group of (N - M + 1) participants. This way if (N - M) co-signers are missing, every private key will be held by at least one of the remaining M people.</p>
<p>Note on MULTISIG_MAX_SIGNERS: During key exchange, participants will have up to '(N - 1) choose (N - M)' key shares. If N is large, then the max number of key shares (when M = (N-1)/2) can be huge. A limit of N &lt;= 16 was arbitrarily chosen as a power of 2 that can accomodate the vast majority of practical use-cases. To increase the limit, FROST-style key aggregation should be used instead (it is more efficient than DH-based key generation when N - M &gt; 1).</p>
<ul>
<li>Further reading<ul>
<li>MRL-0009: <a href="https://www.getmonero.org/resources/research-lab/pubs/MRL-0009.pdf">https://www.getmonero.org/resources/research-lab/pubs/MRL-0009.pdf</a></li>
<li>MuSig2: <a href="https://eprint.iacr.org/2020/1261">https://eprint.iacr.org/2020/1261</a></li>
<li>ZtM2: <a href="https://web.getmonero.org/library/Zero-to-Monero-2-0-0.pdf">https://web.getmonero.org/library/Zero-to-Monero-2-0-0.pdf</a> Ch. 9, especially Section 9.6.3</li>
<li>FROST: <a href="https://eprint.iacr.org/2018/417">https://eprint.iacr.org/2018/417</a> </li>
</ul>
</li>
</ul>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aedc02ee5adda4e01e2369eee64342610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedc02ee5adda4e01e2369eee64342610">&#9670;&nbsp;</a></span>calculate_multisig_keypair_from_derivation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> multisig::calculate_multisig_keypair_from_derivation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a73b9f16c3fec8b0bfab2c7789414e766">crypto::public_key_memsafe</a> &amp;&#160;</td>
          <td class="paramname"><em>derivation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>derived_pubkey_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: calculate_multisig_keypair_from_derivation - wrapper on calculate_multisig_keypair() for an input public key Converts an input public key into a crypto private key (type cast, does not change serialization), then passes it to <a class="el" href="../../de/d6d/namespacemultisig.html#ae28f1a7222fe6e8a5f7e71e9a6133cf5" title="get_multisig_blinded_secret_key - converts an input private key into a blinded multisig private key U...">get_multisig_blinded_secret_key()</a>.</p>
<p>Result:</p><ul>
<li>privkey = H(derivation)</li>
<li>pubkey = privkey * G param: derivation - a curve point outparam: derived_pubkey_out - public key of the resulting privkey return: multisig private key </li>
</ul>

</div>
</div>
<a id="a406dd972934b2cb71f210760bc93e440"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a406dd972934b2cb71f210760bc93e440">&#9670;&nbsp;</a></span>check_messages_round()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void multisig::check_messages_round </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>expanded_msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>expected_round</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: check_messages_round - Check that a set of messages have an expected round number. param: expanded_msgs - set of multisig kex messages to process param: expected_round - round number the kex messages should have </p>

</div>
</div>
<a id="a767371405f256e64d7df80aec9f49537"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a767371405f256e64d7df80aec9f49537">&#9670;&nbsp;</a></span>check_multisig_config()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void multisig::check_multisig_config </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>round</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>num_signers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: check_multisig_config - validate multisig configuration details param: round - the round of the message that should be produced param: threshold - threshold for multisig (M in M-of-N) param: num_signers - number of participants in multisig (N) </p>

</div>
</div>
<a id="a266839b14c87a18a860d8c5fa4b4ca1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a266839b14c87a18a860d8c5fa4b4ca1d">&#9670;&nbsp;</a></span>compute_multisig_aggregation_coefficient()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../df/dbc/structrct_1_1key.html">rct::key</a> multisig::compute_multisig_aggregation_coefficient </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sorted_keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>aggregation_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: compute_multisig_aggregation_coefficient - creates aggregation coefficient for a specific public key in a set of public keys</p>
<p>WARNING: The coefficient will only be deterministic if... 1) input keys are pre-sorted</p><ul>
<li>tested here 2) input keys are in canonical form (compressed points in the prime-order subgroup of Ed25519)</li>
<li>untested here for performance param: sorted_keys - set of component public keys that will be merged into a multisig public spend key param: aggregation_key - one of the component public keys return: aggregation coefficient </li>
</ul>

</div>
</div>
<a id="a4bec541f53feb3e2a5ab08f34c4230c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bec541f53feb3e2a5ab08f34c4230c3">&#9670;&nbsp;</a></span>evaluate_multisig_kex_round_msgs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> multisig::evaluate_multisig_kex_round_msgs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>base_pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>expected_round</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>signers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>expanded_msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exclude_pubkeys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a>&#160;</td>
          <td class="paramname"><em>incomplete_signer_set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: evaluate_multisig_kex_round_msgs - Evaluate pubkeys from a kex round in order to prepare for the next round.</p><ul>
<li>Sanitizes input msgs.</li>
<li>Require uniqueness in: 'exclude_pubkeys'.</li>
<li>Requires each input pubkey be recommended by 'num_recommendations = expected_round' msg signers.<ul>
<li>For a final multisig key to be truly 'M-of-N', each of the the private key's components must be shared by (N - M + 1) signers.</li>
</ul>
</li>
<li>Requires that msgs are signed by only keys in 'signers'.</li>
<li>Requires that each key in 'signers' recommends [num_signers - 2 CHOOSE (expected_round - 1)] pubkeys.<ul>
<li>These should be derivations each signer recommends for round 'expected_round', excluding derivations shared with the local account.</li>
</ul>
</li>
<li>Requires that 'exclude_pubkeys' has [num_signers - 1 CHOOSE (expected_round - 1)] pubkeys.<ul>
<li>These should be derivations the local account has corresponding to round 'expected_round'. param: base_pubkey - multisig account's base public key param: expected_round - expected kex round of input messages param: signers - expected participants in multisig kex param: expanded_msgs - set of multisig kex messages to process param: exclude_pubkeys - derivations held by the local account corresponding to round 'expected_round' param: incomplete_signer_set - only require the minimum number of signers to complete this round minimum = num_signers - (round num - 1) (including local signer) return: fully sanitized and validated pubkey:origins map for building the account's next kex round message </li>
</ul>
</li>
</ul>

</div>
</div>
<a id="a340de528aaea59499f0465d98643c4bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a340de528aaea59499f0465d98643c4bc">&#9670;&nbsp;</a></span>evaluate_multisig_post_kex_round_msgs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> multisig::evaluate_multisig_post_kex_round_msgs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>base_pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>expected_round</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>signers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>expanded_msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a>&#160;</td>
          <td class="paramname"><em>incomplete_signer_set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: evaluate_multisig_post_kex_round_msgs - Evaluate messages for the post-kex verification round.</p><ul>
<li>Sanitizes input msgs.</li>
<li>Requires that only one pubkey is recommended.</li>
<li>Requires that all signers (other than self) recommend that one pubkey. param: base_pubkey - multisig account's base public key param: expected_round - expected kex round of input messages param: signers - expected participants in multisig kex param: expanded_msgs - set of multisig kex messages to process param: incomplete_signer_set - only require the minimum amount of messages to complete this round (1 message) return: sanitized and validated pubkey:origins map </li>
</ul>

</div>
</div>
<a id="acf88908b3440dbc902605f68a886492d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf88908b3440dbc902605f68a886492d">&#9670;&nbsp;</a></span>generate_multisig_aggregate_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> multisig::generate_multisig_aggregate_key </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt;&#160;</td>
          <td class="paramname"><em>final_keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>privkeys_inout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: generate_multisig_aggregate_key - generates a multisig public spend key via key aggregation Key aggregation via aggregation coefficients prevents key cancellation attacks. See: <a href="https://www.getmonero.org/resources/research-lab/pubs/MRL-0009.pdf">https://www.getmonero.org/resources/research-lab/pubs/MRL-0009.pdf</a> param: final_keys - address components (public keys) obtained from other participants (not shared with local) param: privkeys_inout - private keys of address components known by local; each key will be multiplied by an aggregation coefficient (return by reference) return: final multisig public spend key for the account </p>

</div>
</div>
<a id="a007f838abcebaff04b9420518cfc8ad1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a007f838abcebaff04b9420518cfc8ad1">&#9670;&nbsp;</a></span>generate_multisig_composite_key_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a> multisig::generate_multisig_composite_key_image </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/dfd/structcryptonote_1_1account__keys.html">cryptonote::account_keys</a> &amp;&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::unordered_map&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a>, <a class="el" href="../../d0/dad/structcryptonote_1_1subaddress__index.html">cryptonote::subaddress_index</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>subaddresses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>out_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>tx_public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>additional_tx_public_keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>real_output_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#aa037f5696319eb94e5e7bf3210665af0">crypto::key_image</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>pkis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d36/namespacecrypto.html#aa037f5696319eb94e5e7bf3210665af0">crypto::key_image</a> &amp;&#160;</td>
          <td class="paramname"><em>ki</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a732092cc9a0b0c4068e60ab31446a984"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a732092cc9a0b0c4068e60ab31446a984">&#9670;&nbsp;</a></span>generate_multisig_key_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a> multisig::generate_multisig_key_image </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/dfd/structcryptonote_1_1account__keys.html">cryptonote::account_keys</a> &amp;&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>multisig_key_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>out_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d36/namespacecrypto.html#aa037f5696319eb94e5e7bf3210665af0">crypto::key_image</a> &amp;&#160;</td>
          <td class="paramname"><em>ki</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a92b5989e46ab85aafd7ceb21e6735ad6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92b5989e46ab85aafd7ceb21e6735ad6">&#9670;&nbsp;</a></span>generate_multisig_LR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multisig::generate_multisig_LR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a>&#160;</td>
          <td class="paramname"><em>pkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae28f1a7222fe6e8a5f7e71e9a6133cf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28f1a7222fe6e8a5f7e71e9a6133cf5">&#9670;&nbsp;</a></span>get_multisig_blinded_secret_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> multisig::get_multisig_blinded_secret_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get_multisig_blinded_secret_key - converts an input private key into a blinded multisig private key Use 1a: converts account private spend key into multisig private key, which is used for key exchange and message signing Use 1b: converts account private view key into ancillary private key share, for the composite multisig private view key Use 2: converts DH shared secrets (curve points) into private keys, which are intermediate private keys in multisig key exchange </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>- private key to transform </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>transformed private key </dd></dl>

</div>
</div>
<a id="a04f03bb373370ed7b622414bb3faff1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04f03bb373370ed7b622414bb3faff1e">&#9670;&nbsp;</a></span>make_multisig_common_privkey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void multisig::make_multisig_common_privkey </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &gt;&#160;</td>
          <td class="paramname"><em>participant_base_common_privkeys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;&#160;</td>
          <td class="paramname"><em>common_privkey_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: make_multisig_common_privkey - Create the 'common' multisig privkey, owned by all multisig participants.</p><ul>
<li>common privkey = H(sorted base common privkeys) param: participant_base_common_privkeys - <a class="el" href="../../d9/de5/classBase.html">Base</a> common privkeys contributed by multisig participants. outparam: common_privkey_out - result </li>
</ul>

</div>
</div>
<a id="a47fe1e8dcd42b241cbaf950917625168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47fe1e8dcd42b241cbaf950917625168">&#9670;&nbsp;</a></span>multisig_kex_make_round_keys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void multisig::multisig_kex_make_round_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;&#160;</td>
          <td class="paramname"><em>base_privkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a>&#160;</td>
          <td class="paramname"><em>pubkey_origins_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> &amp;&#160;</td>
          <td class="paramname"><em>derivation_origins_map_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: multisig_kex_make_round_keys - Makes a kex round's keys.</p><ul>
<li>Involves DH exchanges with pubkeys provided by other participants.</li>
<li>Conserves mapping [pubkey -&gt; DH derivation] : [origin keys of participants that share this secret with you]. param: base_privkey - account's base private key, for performing DH exchanges and signing messages param: pubkey_origins_map - map between pubkeys to produce DH derivations with and identity keys of participants who will share each derivation with you outparam: derivation_origins_map_out - map between DH derivations (shared secrets) and identity keys </li>
</ul>

</div>
</div>
<a id="a5a56d8fe02530ed4d84ec1e0746a7c97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a56d8fe02530ed4d84ec1e0746a7c97">&#9670;&nbsp;</a></span>multisig_kex_msgs_sanitize_pubkeys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> multisig::multisig_kex_msgs_sanitize_pubkeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>expanded_msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exclude_pubkeys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> &amp;&#160;</td>
          <td class="paramname"><em>sanitized_pubkeys_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: multisig_kex_msgs_sanitize_pubkeys - Sanitize multisig kex messages.</p><ul>
<li>Removes duplicates from msg pubkeys, ignores keys found in input 'exclusion set', constructs map of pubkey:origins.</li>
<li>Requires that all input msgs have the same round number.</li>
</ul>
<p>origins = all the signing pubkeys that recommended a given pubkey found in input msgs</p>
<ul>
<li>If the messages' round numbers are all '1', then only the message signing pubkey is considered 'recommended'. Furthermore, the 'exclusion set' is ignored. param: expanded_msgs - set of multisig kex messages to process param: exclude_pubkeys - pubkeys to exclude from output set outparam: sanitized_pubkeys_out - processed pubkeys obtained from msgs, mapped to their origins return: round number shared by all input msgs </li>
</ul>

</div>
</div>
<a id="abc202f0201f3c63406e9b35b46c678e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc202f0201f3c63406e9b35b46c678e5">&#9670;&nbsp;</a></span>multisig_kex_process_round_msgs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void multisig::multisig_kex_process_round_msgs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a5ff044e8e499775ae7b0ae97d9e00cbd">crypto::secret_key</a> &amp;&#160;</td>
          <td class="paramname"><em>base_privkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>base_pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>current_round</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>signers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../dd/d07/classmultisig_1_1multisig__kex__msg.html">multisig_kex_msg</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>expanded_msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> std::vector&lt; <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exclude_pubkeys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d9/d5e/stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a>&#160;</td>
          <td class="paramname"><em>incomplete_signer_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> &amp;&#160;</td>
          <td class="paramname"><em>keys_to_origins_map_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: multisig_kex_process_round_msgs - Process kex messages for the active kex round.</p><ul>
<li>A wrapper around <a class="el" href="../../de/d6d/namespacemultisig.html#a4bec541f53feb3e2a5ab08f34c4230c3">evaluate_multisig_kex_round_msgs()</a> -&gt; multisig_kex_make_next_msg().<ul>
<li>In other words, evaluate the input messages and try to make a message for the next round.</li>
</ul>
</li>
<li>Note: Must be called on the final round's msgs to evaluate the final key components recommended by other participants. param: base_privkey - multisig account's base private key param: current_round - round of kex the input messages should be designed for param: threshold - threshold for multisig (M in M-of-N) param: signers - expected participants in multisig kex param: expanded_msgs - set of multisig kex messages to process param: exclude_pubkeys - keys held by the local account corresponding to round 'current_round'</li>
<li>If 'current_round' is the final round, these are the local account's shares of the final aggregate key. param: incomplete_signer_set - allow messages from an incomplete signer set outparam: keys_to_origins_map_out - map between round keys and identity keys</li>
<li>If in the final round, these are key shares recommended by other signers for the final aggregate key.</li>
<li>Otherwise, these are the local account's DH derivations for the next round.<ul>
<li>See multisig_kex_make_next_msg() for an explanation. return: multisig kex message for next round, or empty message if 'current_round' is the final round </li>
</ul>
</li>
</ul>

</div>
</div>
<a id="a24dd169089cafe99a971bf8b2a81bee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24dd169089cafe99a971bf8b2a81bee9">&#9670;&nbsp;</a></span>multisig_kex_rounds_required()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> multisig::multisig_kex_rounds_required </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>num_signers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>brief: multisig_kex_rounds_required - The number of key exchange rounds required to produce an M-of-N shared key.</p><ul>
<li>Key exchange (kex) is a synchronous series of 'rounds'. In an 'active round', participants send messages to each other.</li>
<li>A participant considers a round 'complete' when they have collected sufficient messages from other participants, processed those messages, and updated their multisig account state.</li>
<li>Typically (as implemented in this module), completing a round coincides with making a message for the next round. param: num_signers - number of participants in multisig (N) param: threshold - threshold of multisig (M) return: number of kex rounds required </li>
</ul>

</div>
</div>
<a id="a36b1fb3d73726b41ba8c506eb1d519fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36b1fb3d73726b41ba8c506eb1d519fc">&#9670;&nbsp;</a></span>multisig_setup_rounds_required()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> multisig::multisig_setup_rounds_required </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>num_signers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a>&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>brief: multisig_setup_rounds_required - The number of setup rounds required to produce an M-of-N shared key.</p><ul>
<li>A participant must complete all kex rounds and 1 initialization round. param: num_signers - number of participants in multisig (N) param: threshold - threshold of multisig (M) return: number of setup rounds required </li>
</ul>

</div>
</div>
<a id="a9381bc6a9e3cfd995fb4e989e12a571e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9381bc6a9e3cfd995fb4e989e12a571e">&#9670;&nbsp;</a></span>remove_key_from_mapped_sets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void multisig::remove_key_from_mapped_sets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d15/ipfrdr_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../de/d36/namespacecrypto.html#a8ce6a4d94f4c745c4afa8ebc0d16ce1a">crypto::public_key</a> &amp;&#160;</td>
          <td class="paramname"><em>key_to_remove</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d6d/namespacemultisig.html#a8cd9bc62682a68aa4b8eab48774d21f2">multisig_keyset_map_memsafe_t</a> &amp;&#160;</td>
          <td class="paramname"><em>keyset_inout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>INTERNAL</p>
<p>brief: remove_key_from_mapped_sets - Remove a specified key from the mapped sets in a multisig keyset map. param: key_to_remove - specified key to remove inoutparam: keyset_inout - keyset to update </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0ff090816e005304fd727ba22e18d290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ff090816e005304fd727ba22e18d290">&#9670;&nbsp;</a></span>MULTISIG_PUB_ADDRS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">multisig.MULTISIG_PUB_ADDRS</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Sep 2 2023 19:23:38 for Monero by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
