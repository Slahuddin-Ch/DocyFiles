<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Monero: contrib/epee/include/net/levin_protocol_handler_async.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Monero
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_3847941dc22744d30c1d316a1f1a60e2.html">contrib</a></li><li class="navelem"><a class="el" href="../../dir_92a57b9e059663d887c0357307da3ab9.html">epee</a></li><li class="navelem"><a class="el" href="../../dir_a6c98da0acba3a2e75b872d3e159403e.html">include</a></li><li class="navelem"><a class="el" href="../../dir_559e8f98198346615c776f44017fcd94.html">net</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">levin_protocol_handler_async.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../db/d60/levin__protocol__handler__async_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (c) 2006-2013, Andrey N. Sabelnikov, www.sabelnikov.net</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// All rights reserved.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Redistribution and use in source and binary forms, with or without</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// modification, are permitted provided that the following conditions are met:</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// * Redistributions of source code must retain the above copyright</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// notice, this list of conditions and the following disclaimer.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// * Redistributions in binary form must reproduce the above copyright</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// notice, this list of conditions and the following disclaimer in the</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// documentation and/or other materials provided with the distribution.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// * Neither the name of the Andrey N. Sabelnikov nor the</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// names of its contributors may be used to endorse or promote products</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// derived from this software without specific prior written permission.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER  BE LIABLE FOR ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// </span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;boost/asio/deadline_timer.hpp&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;boost/uuid/uuid_generators.hpp&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;boost/unordered_map.hpp&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;boost/smart_ptr/make_shared.hpp&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;deque&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/da4/levin__base_8h.html">levin_base.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d08/buffer_8h.html">buffer.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/dfc/misc__language_8h.html">misc_language.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/ded/syncobj_8h.html">syncobj.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/dba/time__helper_8h.html">time_helper.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d78/int-util_8h.html">int-util.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;random&gt;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;chrono&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#undef MONERO_DEFAULT_LOG_CATEGORY</span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="../../db/d60/levin__protocol__handler__async_8h.html#aa46e84cccc1fb1a44f5762295d51e835">   47</a></span>&#160;<span class="preprocessor">#define MONERO_DEFAULT_LOG_CATEGORY &quot;net&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#ifndef MIN_BYTES_WANTED</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="../../db/d60/levin__protocol__handler__async_8h.html#abaa11629e632147eeac82dfaa5349ad2">   50</a></span>&#160;<span class="preprocessor">#define MIN_BYTES_WANTED    512</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> context_t&gt;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="../../df/d66/levin__abstract__invoke2_8h.html#afaaddc4280dc2b4c337176832e428048">   54</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/d60/levin__protocol__handler__async_8h.html#afaaddc4280dc2b4c337176832e428048">on_levin_traffic</a>(<span class="keyword">const</span> context_t &amp;<a class="code" href="../../de/db0/namespacenet_1_1zmq.html#ae9be1d22949d32a6c7883ae5945978a1">context</a>, <span class="keywordtype">bool</span> initiator, <span class="keywordtype">bool</span> sent, <span class="keywordtype">bool</span> <a class="code" href="../../df/d88/namespacelmdb.html#a9cb8ade56f7bb8b0f875602bede7cd3e">error</a>, <span class="keywordtype">size_t</span> bytes, <span class="keyword">const</span> <span class="keywordtype">char</span>* category)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  MCINFO(<span class="stringliteral">&quot;net.p2p.traffic&quot;</span>, context &lt;&lt; bytes &lt;&lt; <span class="stringliteral">&quot; bytes &quot;</span> &lt;&lt; (sent ? <span class="stringliteral">&quot;sent&quot;</span> : <span class="stringliteral">&quot;received&quot;</span>) &lt;&lt; (error ? <span class="stringliteral">&quot;/corrupt&quot;</span> : <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; for category &quot;</span> &lt;&lt; category &lt;&lt; <span class="stringliteral">&quot; initiated by &quot;</span> &lt;&lt; (initiator ? <span class="stringliteral">&quot;us&quot;</span> : <span class="stringliteral">&quot;peer&quot;</span>));</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> context_t&gt;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="../../df/d66/levin__abstract__invoke2_8h.html#a054e0b03cc6b9875217bc0b371324511">   61</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/d60/levin__protocol__handler__async_8h.html#afaaddc4280dc2b4c337176832e428048">on_levin_traffic</a>(<span class="keyword">const</span> context_t &amp;<a class="code" href="../../de/db0/namespacenet_1_1zmq.html#ae9be1d22949d32a6c7883ae5945978a1">context</a>, <span class="keywordtype">bool</span> initiator, <span class="keywordtype">bool</span> sent, <span class="keywordtype">bool</span> <a class="code" href="../../df/d88/namespacelmdb.html#a9cb8ade56f7bb8b0f875602bede7cd3e">error</a>, <span class="keywordtype">size_t</span> bytes, <span class="keywordtype">int</span> command)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">char</span> <a class="code" href="../../dc/d35/slow__memmem_8cpp.html#ae92da6cbed6002407731bd51f7c6b984">buf</a>[32];</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  snprintf(buf, <span class="keyword">sizeof</span>(buf),  <span class="stringliteral">&quot;command-%u&quot;</span>, command);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="../../db/d60/levin__protocol__handler__async_8h.html#afaaddc4280dc2b4c337176832e428048">on_levin_traffic</a>(context, initiator, sent, error, bytes, buf);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../df/dc7/namespaceepee.html">epee</a></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">namespace </span>levin</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/************************************************************************/</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">/*                                                                      */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">/************************************************************************/</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">   77</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html">   80</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html">async_protocol_handler_config</a></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a549bf87686bfdf473b44b0d2c9fadcb8">   82</a></span>&#160;  <span class="keyword">typedef</span> boost::unordered_map&lt;boost::uuids::uuid, async_protocol_handler&lt;t_connection_context&gt;* &gt; <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a549bf87686bfdf473b44b0d2c9fadcb8">connections_map</a>;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8868445ae3885a65ed30130bdd3ba5a8">   83</a></span>&#160;  <a class="code" href="../../df/d71/classepee_1_1critical__section.html">critical_section</a> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8868445ae3885a65ed30130bdd3ba5a8">m_connects_lock</a>;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#adf1a6f746e63d0f007a84bcc7ab2f205">   84</a></span>&#160;  connections_map <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#adf1a6f746e63d0f007a84bcc7ab2f205">m_connects</a>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8fcaff270713d22805656eeb49b859b1">add_connection</a>(<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* pc);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#acbbb8de2208d86d282441ec01932cab5">del_connection</a>(<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* pc);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a2aefffdba133dc76afbe098d67e0aa65">find_connection</a>(<a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id) <span class="keyword">const</span>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">find_and_lock_connection</a>(<a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id, <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>*&amp; aph);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a41ccdd3297f294528633ad5f626fb930">   92</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler</a>&lt;t_connection_context&gt;;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a511f8d81b68f7bf51d1d9148b9a080ba">   94</a></span>&#160;  <a class="code" href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html">levin_commands_handler&lt;t_connection_context&gt;</a>* <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a511f8d81b68f7bf51d1d9148b9a080ba">m_pcommands_handler</a>;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a343a368e7a9b7ff8bdebd713b45bbef0">   95</a></span>&#160;  void (*<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a343a368e7a9b7ff8bdebd713b45bbef0">m_pcommands_handler_destroy</a>)(<a class="code" href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html">levin_commands_handler&lt;t_connection_context&gt;</a>*);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a64079d8a3784b04ff0ee7c1a36b6bcd8">delete_connections</a> (<span class="keywordtype">size_t</span> <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>, <span class="keywordtype">bool</span> incoming);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a6250c0ea64875d182f6584cadecc788b">  100</a></span>&#160;  <span class="keyword">typedef</span> t_connection_context <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a6250c0ea64875d182f6584cadecc788b">connection_context</a>;</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#aed134afb5690dfb39642e7fc6a36bcaa">  101</a></span>&#160;  <a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#aed134afb5690dfb39642e7fc6a36bcaa">m_initial_max_packet_size</a>;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a559a37baaae8507544d8f21e5f872e9b">  102</a></span>&#160;  <a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a559a37baaae8507544d8f21e5f872e9b">m_max_packet_size</a>;</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a87447e1e73f8d89c189bf428b7f9ac4f">  103</a></span>&#160;  <a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a87447e1e73f8d89c189bf428b7f9ac4f">m_invoke_timeout</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#ac059443ab409c3180b9281013f2359e6">invoke</a>(<span class="keywordtype">int</span> command, <a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html">message_writer</a> in_msg, <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a5ca8a348395a6145775c1a2334e21889">std::string</a>&amp; buff_out, <a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> callback_t&gt;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#ac6eb706056fcad88cd35b67d850378d8">invoke_async</a>(<span class="keywordtype">int</span> command, <a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html">message_writer</a> in_msg, <a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id, <span class="keyword">const</span> callback_t &amp;cb, <span class="keywordtype">size_t</span> timeout = <a class="code" href="../../d2/da4/levin__base_8h.html#adc3c0671eb36e04ca369816c36f21a1b">LEVIN_DEFAULT_TIMEOUT_PRECONFIGURED</a>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a5261b7c947b0457b1f9bf262590a6612">send</a>(<a class="code" href="../../d0/d9e/classepee_1_1byte__slice.html">epee::byte_slice</a> <a class="code" href="../../d6/dc2/namespacegtest__output__test.html#ac696d0798ad7d08cb2e61070824750e2">message</a>, <span class="keyword">const</span> <a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a>&amp; connection_id);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9052ea623aafad44b54bd0da107c7d2c">close</a>(<a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8798dd25f119812f631a56366a4c2f3e">update_connection_context</a>(<span class="keyword">const</span> t_connection_context&amp; contxt);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a064b3846f4ea1942cbd26c78c342575d">request_callback</a>(<a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> callback_t&gt;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a4a41b55917e89104e2d65400b5849786">foreach_connection</a>(<span class="keyword">const</span> callback_t &amp;cb);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> callback_t&gt;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a4046568fefb64f4ef1ee07d7c86f573c">for_connection</a>(<span class="keyword">const</span> <a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> &amp;connection_id, <span class="keyword">const</span> callback_t &amp;cb);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a100e213bf9e527a15f529eca1cb248f3">get_connections_count</a>();</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9238187db44e261baafc2dfccaa460d4">get_out_connections_count</a>();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#aeab87b0a2a3b936e5aa2d3860544715b">get_in_connections_count</a>();</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a83046603800352cae8978c26b4f823c9">set_handler</a>(<a class="code" href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html">levin_commands_handler&lt;t_connection_context&gt;</a>* handler, <span class="keywordtype">void</span> (*destroy)(<a class="code" href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html">levin_commands_handler&lt;t_connection_context&gt;</a>*) = NULL);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a0553b5503145b64ea12141b3f01d18fb">  122</a></span>&#160;  <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a0553b5503145b64ea12141b3f01d18fb">async_protocol_handler_config</a>():m_pcommands_handler(NULL), <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a343a368e7a9b7ff8bdebd713b45bbef0">m_pcommands_handler_destroy</a>(NULL), m_initial_max_packet_size(<a class="code" href="../../d2/da4/levin__base_8h.html#a34200c1790d28e01ac6d782ff70d9543">LEVIN_INITIAL_MAX_PACKET_SIZE</a>), m_max_packet_size(<a class="code" href="../../d2/da4/levin__base_8h.html#a6d318750e44a88f864d4bca373448098">LEVIN_DEFAULT_MAX_PACKET_SIZE</a>), m_invoke_timeout(<a class="code" href="../../d2/da4/levin__base_8h.html#adc3c0671eb36e04ca369816c36f21a1b">LEVIN_DEFAULT_TIMEOUT_PRECONFIGURED</a>)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  {}</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a0efb2a425fa24b034004cbcf5f8e4666">  124</a></span>&#160;  <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a0efb2a425fa24b034004cbcf5f8e4666">~async_protocol_handler_config</a>() { <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a83046603800352cae8978c26b4f823c9">set_handler</a>(NULL, NULL); }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a81deb95abb05c9cecafabd662a4fe334">del_out_connections</a>(<span class="keywordtype">size_t</span> <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a95a9ebf87aa9760c503fc607f24f88b6">del_in_connections</a>(<span class="keywordtype">size_t</span> count);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;};</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/************************************************************************/</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">/*                                                                      */</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">/************************************************************************/</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context = net_utils::connection_context_base&gt;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">class </span><a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler</a></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a1a7f0bc95c8394122fb29c5fa66ddb9e">  136</a></span>&#160;  <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a5ca8a348395a6145775c1a2334e21889">std::string</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a1a7f0bc95c8394122fb29c5fa66ddb9e">m_fragment_buffer</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a02e983647e496f39159fd4eb3b0dd409">  138</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a02e983647e496f39159fd4eb3b0dd409">send_message</a>(<a class="code" href="../../d0/d9e/classepee_1_1byte__slice.html">byte_slice</a> <a class="code" href="../../d6/dc2/namespacegtest__output__test.html#ac696d0798ad7d08cb2e61070824750e2">message</a>)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (message.<a class="code" href="../../d0/d9e/classepee_1_1byte__slice.html#aa04dda0b9f60d823c76b034467faebe3">size</a>() &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html#af22cb9d621ac925792ccad1113754dcc">message_writer::header</a>))</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">message_writer::header</a> head;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="../../d5/d9f/glibc__compat_8cpp.html#a0f46826ab0466591e136db24394923cf">std::memcpy</a>(std::addressof(head), message.<a class="code" href="../../d0/d9e/classepee_1_1byte__slice.html#ae0eeb6f797cdaf8f7024ff60f9976fe8">data</a>(), <span class="keyword">sizeof</span>(head));</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span>(!m_pservice_endpoint-&gt;do_send(<a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#aa1114d84589bd22f45d443527528cb35">std::move</a>(message)))</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../db/d60/levin__protocol__handler__async_8h.html#afaaddc4280dc2b4c337176832e428048">on_levin_traffic</a>(m_connection_context, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a>, head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a>);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    MDEBUG(m_connection_context &lt;&lt; <span class="stringliteral">&quot;LEVIN_PACKET_SENT. [len=&quot;</span> &lt;&lt; head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, flags&quot;</span> &lt;&lt; head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">m_flags</a></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, r?=&quot;</span> &lt;&lt; head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#af8ce8d9bfa19fe65939b7dd68c8ec906">m_have_to_return_data</a></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        &lt;&lt;<span class="stringliteral">&quot;, cmd = &quot;</span> &lt;&lt; head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, ver=&quot;</span> &lt;&lt; head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a094085ef90064a595ff6e04409e50d3f">m_protocol_version</a>);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a55c5aaba60e0e74af1b82246af0bf8d1">  158</a></span>&#160;  <span class="keyword">typedef</span> t_connection_context <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a55c5aaba60e0e74af1b82246af0bf8d1">connection_context</a>;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abe92ac2f6babec8692c49ee46e033488">  159</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html">async_protocol_handler_config&lt;t_connection_context&gt;</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abe92ac2f6babec8692c49ee46e033488">config_type</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aad90321d53de3e88730efa55c96239b9">  161</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aad90321d53de3e88730efa55c96239b9">stream_state</a></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  {</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aad90321d53de3e88730efa55c96239b9afd107b79ac6160239ae422705c232abb">  163</a></span>&#160;    <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aad90321d53de3e88730efa55c96239b9afd107b79ac6160239ae422705c232abb">stream_state_head</a>,</div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aad90321d53de3e88730efa55c96239b9a37909c50612fba841bb8a167daf05e6b">  164</a></span>&#160;    stream_state_body</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  };</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4aaf4690161cdb29dbbd207df261a9d">  167</a></span>&#160;  std::atomic&lt;bool&gt; <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4aaf4690161cdb29dbbd207df261a9d">m_protocol_released</a>;</div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a7d8a38d11e362e84273c9b8cfd2d3a7d">  168</a></span>&#160;  std::atomic&lt;bool&gt; <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a7d8a38d11e362e84273c9b8cfd2d3a7d">m_invoke_buf_ready</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abd4b6a50ce3a6f1a2a7f4e43ceb41889">  170</a></span>&#160;  <span class="keyword">volatile</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abd4b6a50ce3a6f1a2a7f4e43ceb41889">m_invoke_result_code</a>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a5f796258eda9a321ed5a528fc5149da5">  172</a></span>&#160;  <a class="code" href="../../df/d71/classepee_1_1critical__section.html">critical_section</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a5f796258eda9a321ed5a528fc5149da5">m_local_inv_buff_lock</a>;</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a01a7fd533a073d3b7e42d54a8559971b">  173</a></span>&#160;  <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a5ca8a348395a6145775c1a2334e21889">std::string</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a01a7fd533a073d3b7e42d54a8559971b">m_local_inv_buff</a>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a10ad1f1876109b35e117de5e94479725">  175</a></span>&#160;  <a class="code" href="../../df/d71/classepee_1_1critical__section.html">critical_section</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a10ad1f1876109b35e117de5e94479725">m_call_lock</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a054a9fe3bf3051813ef8d0e241c4653d">  177</a></span>&#160;  std::atomic&lt;uint32_t&gt; <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a054a9fe3bf3051813ef8d0e241c4653d">m_wait_count</a>;</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af6d9aa3e695273337aa11df2b80e1398">  178</a></span>&#160;  std::atomic&lt;uint32_t&gt; <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af6d9aa3e695273337aa11df2b80e1398">m_close_called</a>;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ac089e912a905e37b466a2af35ebefeac">  179</a></span>&#160;  <a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ac089e912a905e37b466a2af35ebefeac">m_current_head</a>;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a3ac55b4bbc94549be37fd8b63b91e7ec">  180</a></span>&#160;  <a class="code" href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html">net_utils::i_service_endpoint</a>* <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a3ac55b4bbc94549be37fd8b63b91e7ec">m_pservice_endpoint</a>; </div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abc827c6a4c19fe6eb0eefa64c6a682ab">  181</a></span>&#160;  config_type&amp; <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abc827c6a4c19fe6eb0eefa64c6a682ab">m_config</a>;</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ab44fe47607db1b3159d015d5335c6b8a">  182</a></span>&#160;  t_connection_context&amp; <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ab44fe47607db1b3159d015d5335c6b8a">m_connection_context</a>;</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a38462fe3565a1611ced14a02dbfe614e">  183</a></span>&#160;  std::atomic&lt;uint64_t&gt; <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a38462fe3565a1611ced14a02dbfe614e">m_max_packet_size</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aca2dd292de4f81ad5ca799d308622f5e">  185</a></span>&#160;  <a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html">net_utils::buffer</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aca2dd292de4f81ad5ca799d308622f5e">m_cache_in_buffer</a>;</div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a90748de7854397764729518eaef396b5">  186</a></span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aad90321d53de3e88730efa55c96239b9">stream_state</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a90748de7854397764729518eaef396b5">m_state</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a1bb966d6e3aff44a4eb0158b24afc2f1">  188</a></span>&#160;  <a class="code" href="../../df/dd8/stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a1bb966d6e3aff44a4eb0158b24afc2f1">m_oponent_protocol_ver</a>;</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a8de11cd1fbdc31b72d869dbf598af25b">  189</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a8de11cd1fbdc31b72d869dbf598af25b">m_connection_initialized</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="../../d2/dbd/structepee_1_1levin_1_1async__protocol__handler_1_1invoke__response__handler__base.html">  191</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d2/dbd/structepee_1_1levin_1_1async__protocol__handler_1_1invoke__response__handler__base.html">invoke_response_handler_base</a></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> handle(<span class="keywordtype">int</span> <a class="code" href="../../df/d8f/hmac__keccak_8cpp.html#ab4fd73a44e0cd1bee88072b7e02d8b7c">res</a>, <span class="keyword">const</span> <a class="code" href="../../d0/d87/classepee_1_1span.html">epee::span&lt;const uint8_t&gt;</a> buff, connection_context&amp; <a class="code" href="../../de/db0/namespacenet_1_1zmq.html#ae9be1d22949d32a6c7883ae5945978a1">context</a>)=0;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> is_timer_started() <span class="keyword">const</span>=0;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> cancel()=0;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> cancel_timer()=0;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> reset_timer()=0;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  };</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> callback_t&gt;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html">  200</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html">anvoke_handler</a>: <a class="code" href="../../d2/dbd/structepee_1_1levin_1_1async__protocol__handler_1_1invoke__response__handler__base.html">invoke_response_handler_base</a></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  {</div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a9d4351caa3ef1771873dcaf7825af8f7">  202</a></span>&#160;    <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a9d4351caa3ef1771873dcaf7825af8f7">anvoke_handler</a>(<span class="keyword">const</span> callback_t&amp; cb, <a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> timeout,  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler</a>&amp; con, <span class="keywordtype">int</span> command)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      :m_cb(cb), m_timeout(timeout), m_con(con), m_timer(con.m_pservice_endpoint-&gt;get_io_service()), m_timer_started(<a class="code" href="../../d9/d5e/stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>),</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      m_cancel_timer_called(<a class="code" href="../../d9/d5e/stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>), m_timer_cancelled(<a class="code" href="../../d9/d5e/stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>), m_command(command)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">if</span>(m_con.start_outer_call())</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        MDEBUG(con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">get_context_ref</a>() &lt;&lt; <span class="stringliteral">&quot;anvoke_handler, timeout: &quot;</span> &lt;&lt; timeout);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        m_timer.expires_from_now(boost::posix_time::milliseconds(timeout));</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        m_timer.async_wait([&amp;con, command, cb, timeout](<span class="keyword">const</span> boost::system::error_code&amp; ec)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <span class="keywordflow">if</span>(ec == boost::asio::error::operation_aborted)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          MINFO(con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">get_context_ref</a>() &lt;&lt; <span class="stringliteral">&quot;Timeout on invoke operation happened, command: &quot;</span> &lt;&lt; command &lt;&lt; <span class="stringliteral">&quot; timeout: &quot;</span> &lt;&lt; timeout);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <a class="code" href="../../d0/d87/classepee_1_1span.html">epee::span&lt;const uint8_t&gt;</a> fake;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          cb(<a class="code" href="../../d2/da4/levin__base_8h.html#ae958211ab5044e294951c38d03033d70">LEVIN_ERROR_CONNECTION_TIMEDOUT</a>, fake, con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">get_context_ref</a>());</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a4ddeb783e06601e3af44798339257b15">close</a>();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">finish_outer_call</a>();</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        });</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        m_timer_started = <span class="keyword">true</span>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a8444d751fa2b3910096d7e880b6a8d9d">  223</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a8444d751fa2b3910096d7e880b6a8d9d">~anvoke_handler</a>()</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {}</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a53e4490cedbf202dd990c6d2b787e31d">  225</a></span>&#160;    callback_t <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a53e4490cedbf202dd990c6d2b787e31d">m_cb</a>;</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a4d1b094c35df709f464ea2d50120ad64">  226</a></span>&#160;    <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler</a>&amp; <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a4d1b094c35df709f464ea2d50120ad64">m_con</a>;</div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a6f155286cc92689928ae3544546328d2">  227</a></span>&#160;    boost::asio::deadline_timer <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a6f155286cc92689928ae3544546328d2">m_timer</a>;</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a310e632d8f7e30ee594442940f4cf096">  228</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a310e632d8f7e30ee594442940f4cf096">m_timer_started</a>;</div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#af4b74b0d1ed643e9f252dab768b54c65">  229</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#af4b74b0d1ed643e9f252dab768b54c65">m_cancel_timer_called</a>;</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#ada987f3850cb6b6727a2d3125fa19bdb">  230</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#ada987f3850cb6b6727a2d3125fa19bdb">m_timer_cancelled</a>;</div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a570039c44ea723cb6e347ba763ef9139">  231</a></span>&#160;    <a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a570039c44ea723cb6e347ba763ef9139">m_timeout</a>;</div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#aafa934af083f78f578f042a6dbfb93d2">  232</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#aafa934af083f78f578f042a6dbfb93d2">m_command</a>;</div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a5ae134a1c84b424ee042e9bd3bb9ad3b">  233</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a5ae134a1c84b424ee042e9bd3bb9ad3b">handle</a>(<span class="keywordtype">int</span> <a class="code" href="../../df/d8f/hmac__keccak_8cpp.html#ab4fd73a44e0cd1bee88072b7e02d8b7c">res</a>, <span class="keyword">const</span> <a class="code" href="../../d0/d87/classepee_1_1span.html">epee::span&lt;const uint8_t&gt;</a> buff, <span class="keyword">typename</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a55c5aaba60e0e74af1b82246af0bf8d1">async_protocol_handler::connection_context</a>&amp; <a class="code" href="../../de/db0/namespacenet_1_1zmq.html#ae9be1d22949d32a6c7883ae5945978a1">context</a>)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordflow">if</span>(!cancel_timer())</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      m_cb(res, buff, context);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      m_con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">finish_outer_call</a>();</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#aa418f5701bfe66bafe945684cec26775">  241</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#aa418f5701bfe66bafe945684cec26775">is_timer_started</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">return</span> m_timer_started;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a686b31062d3899b129005f4d45ca9c4f">  245</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a686b31062d3899b129005f4d45ca9c4f">cancel</a>()</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">if</span>(cancel_timer())</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="../../d0/d87/classepee_1_1span.html">epee::span&lt;const uint8_t&gt;</a> fake;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        m_cb(<a class="code" href="../../d2/da4/levin__base_8h.html#a9497e6e3132b6c55af7c4b2fc58c8554">LEVIN_ERROR_CONNECTION_DESTROYED</a>, fake, m_con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">get_context_ref</a>());</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        m_con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">finish_outer_call</a>();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#ab6a6a1e55430ced4eedf18922b177333">  254</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#ab6a6a1e55430ced4eedf18922b177333">cancel_timer</a>()</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">if</span>(!m_cancel_timer_called)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        m_cancel_timer_called = <span class="keyword">true</span>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        boost::system::error_code ignored_ec;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        m_timer_cancelled = 1 == m_timer.cancel(ignored_ec);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordflow">return</span> m_timer_cancelled;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#afa8f16259970e349d53c1ba8b7f42efb">  264</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#afa8f16259970e349d53c1ba8b7f42efb">reset_timer</a>()</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      boost::system::error_code ignored_ec;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">if</span> (!m_cancel_timer_called &amp;&amp; m_timer.cancel(ignored_ec) &gt; 0)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        callback_t&amp; cb = m_cb;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> timeout = m_timeout;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler</a>&amp; con = m_con;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordtype">int</span> command = m_command;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        m_timer.expires_from_now(boost::posix_time::milliseconds(m_timeout));</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        m_timer.async_wait([&amp;con, cb, command, timeout](<span class="keyword">const</span> boost::system::error_code&amp; ec)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <span class="keywordflow">if</span>(ec == boost::asio::error::operation_aborted)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          MINFO(con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">get_context_ref</a>() &lt;&lt; <span class="stringliteral">&quot;Timeout on invoke operation happened, command: &quot;</span> &lt;&lt; command &lt;&lt; <span class="stringliteral">&quot; timeout: &quot;</span> &lt;&lt; timeout);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <a class="code" href="../../d0/d87/classepee_1_1span.html">epee::span&lt;const uint8_t&gt;</a> fake;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          cb(<a class="code" href="../../d2/da4/levin__base_8h.html#ae958211ab5044e294951c38d03033d70">LEVIN_ERROR_CONNECTION_TIMEDOUT</a>, fake, con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">get_context_ref</a>());</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a4ddeb783e06601e3af44798339257b15">close</a>();</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          con.<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">finish_outer_call</a>();</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        });</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  };</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a3dd3b8d3d0bd546fc90c6e18529012f1">  287</a></span>&#160;  <a class="code" href="../../df/d71/classepee_1_1critical__section.html">critical_section</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a3dd3b8d3d0bd546fc90c6e18529012f1">m_invoke_response_handlers_lock</a>;</div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a89702fd14fc0d7548c1d297ecbb6f7e8">  288</a></span>&#160;  std::list&lt;boost::shared_ptr&lt;invoke_response_handler_base&gt; &gt; <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a89702fd14fc0d7548c1d297ecbb6f7e8">m_invoke_response_handlers</a>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> callback_t&gt;</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a36b76e290bc759412a876ffa2c1f4fe4">  291</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a36b76e290bc759412a876ffa2c1f4fe4">add_invoke_response_handler</a>(<span class="keyword">const</span> callback_t &amp;cb, <a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> timeout,  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler</a>&amp; con, <span class="keywordtype">int</span> command)</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_invoke_response_handlers_lock);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (m_protocol_released)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      MERROR(<span class="stringliteral">&quot;Adding response handler to a released object&quot;</span>);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    boost::shared_ptr&lt;invoke_response_handler_base&gt; handler(boost::make_shared&lt;<a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html">anvoke_handler&lt;callback_t&gt;</a>&gt;(cb, timeout, con, command));</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    m_invoke_response_handlers.push_back(handler);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">return</span> handler-&gt;is_timer_started();</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div><div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#afae1cdb9941ad669ed709dd343cb5ee9">  303</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> callback_t&gt; <span class="keyword">friend</span> <span class="keyword">struct </span><a class="code" href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html">anvoke_handler</a>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ac66fdfc8b515eb7749a293b0a8244b83">  305</a></span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ac66fdfc8b515eb7749a293b0a8244b83">async_protocol_handler</a>(<a class="code" href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html">net_utils::i_service_endpoint</a>* psnd_hndlr, </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    config_type&amp; <a class="code" href="../../d6/d7f/namespaceconfig.html">config</a>, </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    t_connection_context&amp; conn_context):</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            m_current_head(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>()),</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            m_pservice_endpoint(psnd_hndlr), </div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            m_config(config), </div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            m_connection_context(conn_context),</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            m_max_packet_size(config.m_initial_max_packet_size),</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            m_cache_in_buffer(4 * 1024),</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            m_state(stream_state_head)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    m_close_called = 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    m_protocol_released = <span class="keyword">false</span>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    m_wait_count = 0;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    m_oponent_protocol_ver = 0;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    m_connection_initialized = <span class="keyword">false</span>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    m_invoke_buf_ready = <span class="keyword">false</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    m_invoke_result_code = <a class="code" href="../../d2/da4/levin__base_8h.html#a1d9eddb66c14d27facb30fafdbca6eb0">LEVIN_ERROR_CONNECTION</a>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }</div><div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a629f66cdbe5ed91a3cc32762d81ea623">  324</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a629f66cdbe5ed91a3cc32762d81ea623">~async_protocol_handler</a>()</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">try</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">if</span>(m_connection_initialized)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#acbbb8de2208d86d282441ec01932cab5">del_connection</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a> = 0; <a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a> &lt; 60 * 1000 / 100 &amp;&amp; 0 != m_wait_count; ++<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a>)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#a66aec447ca7af52caf4a49e8d2e5d560">misc_utils::sleep_no_w</a>(100);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    CHECK_AND_ASSERT_MES_NO_RET(0 == m_wait_count, <span class="stringliteral">&quot;Failed to wait for operation completion. m_wait_count = &quot;</span> &lt;&lt; m_wait_count.load());</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    MTRACE(m_connection_context &lt;&lt; <span class="stringliteral">&quot;~async_protocol_handler()&quot;</span>);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">catch</span> (...) { <span class="comment">/* ignore */</span> }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ab3dbcfccfc8a62b02daf12706176cffc">  346</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ab3dbcfccfc8a62b02daf12706176cffc">start_outer_call</a>()</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    MTRACE(m_connection_context &lt;&lt; <span class="stringliteral">&quot;[levin_protocol] --&gt;&gt; start_outer_call&quot;</span>);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span>(!m_pservice_endpoint-&gt;<a class="code" href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#ae038820c93497baa197ef836f0eeacb0">add_ref</a>())</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      MERROR(m_connection_context &lt;&lt; <span class="stringliteral">&quot;[levin_protocol] --&gt;&gt; start_outer_call failed&quot;</span>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    ++m_wait_count;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  }</div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">  357</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">finish_outer_call</a>()</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    MTRACE(m_connection_context &lt;&lt; <span class="stringliteral">&quot;[levin_protocol] &lt;&lt;-- finish_outer_call&quot;</span>);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    --m_wait_count;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    m_pservice_endpoint-&gt;<a class="code" href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#a679e32d0a9eb0fd78528b87b8db8fd4d">release</a>();</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a3467939ab1ad5d10ae4bbfdc81c12f72">  365</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a3467939ab1ad5d10ae4bbfdc81c12f72">release_protocol</a>()</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    decltype(m_invoke_response_handlers) local_invoke_response_handlers;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="../../d6/ded/syncobj_8h.html#adfcc7bf6d03ea34dbc9692a115c53da2">CRITICAL_REGION_BEGIN</a>(m_invoke_response_handlers_lock);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    local_invoke_response_handlers.swap(m_invoke_response_handlers);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    m_protocol_released = <span class="keyword">true</span>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="../../d6/ded/syncobj_8h.html#ac084672ad3029b635392dad8f94cd2de">CRITICAL_REGION_END</a>();</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Never call callback inside critical section, that can cause deadlock. Callback can be called when</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// invoke_response_handler_base is cancelled</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    std::for_each(local_invoke_response_handlers.begin(), local_invoke_response_handlers.end(), [](<span class="keyword">const</span> boost::shared_ptr&lt;invoke_response_handler_base&gt;&amp; pinv_resp_hndlr) {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      pinv_resp_hndlr-&gt;cancel();</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    });</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  </div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a4ddeb783e06601e3af44798339257b15">  382</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a4ddeb783e06601e3af44798339257b15">close</a>()</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  {    </div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    ++m_close_called;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    m_pservice_endpoint-&gt;<a class="code" href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#ad2655ea4cb2f0dc05992ba60a86f76d6">close</a>();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a533976eb424aff6ac1002cb39b87033d">  390</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a533976eb424aff6ac1002cb39b87033d">update_connection_context</a>(<span class="keyword">const</span> connection_context&amp; contxt)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    m_connection_context = contxt;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a5628fd6257bcc237565912271a848485">  395</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a5628fd6257bcc237565912271a848485">request_callback</a>()</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#a0b437906f4dc191bb47ae0d83739bc55">misc_utils::auto_scope_leave_caller</a> scope_exit_handler = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#ab69958a85696a5d3e6be09f424e3487c">misc_utils::create_scope_leave_handler</a>(</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      boost::bind(&amp;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">async_protocol_handler::finish_outer_call</a>, <span class="keyword">this</span>));</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    m_pservice_endpoint-&gt;<a class="code" href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#a2772195d6f8fac200406254737d95a22">request_callback</a>();</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a02eeca929b3df5602f3178c5b7e23bd0">  403</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a02eeca929b3df5602f3178c5b7e23bd0">handle_qued_callback</a>()   </div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a511f8d81b68f7bf51d1d9148b9a080ba">m_pcommands_handler</a>-&gt;callback(m_connection_context);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a54e7914a95003c077f8db3294f88a6bc">  408</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a54e7914a95003c077f8db3294f88a6bc">handle_recv</a>(<span class="keyword">const</span> <span class="keywordtype">void</span>* ptr, <span class="keywordtype">size_t</span> cb)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span>(m_close_called)</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">//closing connections</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span>(!m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a511f8d81b68f7bf51d1d9148b9a080ba">m_pcommands_handler</a>)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      MERROR(m_connection_context &lt;&lt; <span class="stringliteral">&quot;Commands handler not set!&quot;</span>);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// these should never fail, but do runtime check for safety</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> max_packet_size = <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a559a37baaae8507544d8f21e5f872e9b">m_max_packet_size</a>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    CHECK_AND_ASSERT_MES(max_packet_size &gt;= m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>(), <span class="keyword">false</span>, <span class="stringliteral">&quot;Bad m_cache_in_buffer.size()&quot;</span>);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    CHECK_AND_ASSERT_MES(max_packet_size - m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>() &gt;= m_fragment_buffer.size(), <span class="keyword">false</span>, <span class="stringliteral">&quot;Bad m_cache_in_buffer.size() + m_fragment_buffer.size()&quot;</span>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// flipped to subtraction; prevent overflow since m_max_packet_size is variable and public</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span>(cb &gt; max_packet_size - m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>() - m_fragment_buffer.size())</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      MWARNING(m_connection_context &lt;&lt; <span class="stringliteral">&quot;Maximum packet size exceed!, m_max_packet_size = &quot;</span> &lt;&lt; max_packet_size</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;, packet received &quot;</span> &lt;&lt; m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>() +  cb </div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;, connection will be closed.&quot;</span>);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#ab0c17f92d3295e90b085e261ca2273c0">append</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)ptr, cb);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">bool</span> is_continue = <span class="keyword">true</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">while</span>(is_continue)</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">switch</span>(m_state)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">case</span> stream_state_body:</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span>(m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>() &lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a>)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          is_continue = <span class="keyword">false</span>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          <span class="keywordflow">if</span>(cb &gt;= <a class="code" href="../../db/d60/levin__protocol__handler__async_8h.html#abaa11629e632147eeac82dfaa5349ad2">MIN_BYTES_WANTED</a>)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_invoke_response_handlers_lock);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordflow">if</span> (!m_invoke_response_handlers.empty())</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;              <span class="comment">//async call scenario</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;              boost::shared_ptr&lt;invoke_response_handler_base&gt; response_handler = m_invoke_response_handlers.front();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;              response_handler-&gt;reset_timer();</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;              MDEBUG(m_connection_context &lt;&lt; <span class="stringliteral">&quot;LEVIN_PACKET partial msg received. len=&quot;</span> &lt;&lt; cb &lt;&lt; <span class="stringliteral">&quot;, current total &quot;</span> &lt;&lt; m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a> &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; (100.0f * m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>() / (m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a> ? m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a> : 1)) &lt;&lt; <span class="stringliteral">&quot;%)&quot;</span>);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a5ca8a348395a6145775c1a2334e21889">std::string</a> temp{};</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          <a class="code" href="../../d0/d87/classepee_1_1span.html">epee::span&lt;const uint8_t&gt;</a> buff_to_invoke = m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#aa77da0ab67d8411f7e64c2f79a5cf3ec">carve</a>((std::string::size_type)m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          m_state = stream_state_head;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          <span class="comment">// abstract_tcp_server2.h manages max bandwidth for a p2p link</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          <span class="keywordflow">if</span> (!(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">m_flags</a> &amp; (<a class="code" href="../../d2/da4/levin__base_8h.html#a590aba0578116971f9711a9f9d097835">LEVIN_PACKET_REQUEST</a> | <a class="code" href="../../d2/da4/levin__base_8h.html#a05934671a178c49b457228cc44ab7e3b">LEVIN_PACKET_RESPONSE</a>)))</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="comment">// special noise/fragment command</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keyword">static</span> constexpr <span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> both_flags = (<a class="code" href="../../d2/da4/levin__base_8h.html#aa34805f1cc19431602149596f1dad61a">LEVIN_PACKET_BEGIN</a> | <a class="code" href="../../d2/da4/levin__base_8h.html#a38297b0714311bedc4a443077d5f5edc">LEVIN_PACKET_END</a>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordflow">if</span> ((m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">m_flags</a> &amp; both_flags) == both_flags)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;              <span class="keywordflow">break</span>; <span class="comment">// noise message, skip to next message</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordflow">if</span> (m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">m_flags</a> &amp; <a class="code" href="../../d2/da4/levin__base_8h.html#aa34805f1cc19431602149596f1dad61a">LEVIN_PACKET_BEGIN</a>)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;              m_fragment_buffer.clear();</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            m_fragment_buffer.append(reinterpret_cast&lt;const char*&gt;(buff_to_invoke.<a class="code" href="../../d0/d87/classepee_1_1span.html#af9959653eb0d2f90fefd449016b9e8c2">data</a>()), buff_to_invoke.<a class="code" href="../../d0/d87/classepee_1_1span.html#a6e69e80f2a8cf12c9b1df55c7d9618aa">size</a>());</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">if</span> (!(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">m_flags</a> &amp; <a class="code" href="../../d2/da4/levin__base_8h.html#a38297b0714311bedc4a443077d5f5edc">LEVIN_PACKET_END</a>))</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;              <span class="keywordflow">break</span>; <span class="comment">// skip to next message</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">if</span> (m_fragment_buffer.size() &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>))</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;              MERROR(m_connection_context &lt;&lt; <span class="stringliteral">&quot;Fragmented data too small for levin header&quot;</span>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            temp = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#aa1114d84589bd22f45d443527528cb35">std::move</a>(m_fragment_buffer);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            m_fragment_buffer.clear();</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <a class="code" href="../../d5/d9f/glibc__compat_8cpp.html#a0f46826ab0466591e136db24394923cf">std::memcpy</a>(std::addressof(m_current_head), std::addressof(temp[0]), <span class="keyword">sizeof</span>(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>));</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">size_t</span> max_bytes = m_connection_context.get_max_bytes(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">if</span>(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a> &gt; std::min&lt;size_t&gt;(max_packet_size, max_bytes))</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;              MERROR(m_connection_context &lt;&lt; <span class="stringliteral">&quot;Maximum packet size exceed!, m_max_packet_size = &quot;</span> &lt;&lt; std::min&lt;size_t&gt;(max_packet_size, max_bytes)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, packet header received &quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a> &lt;&lt; <span class="stringliteral">&quot;, command &quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, connection will be closed.&quot;</span>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            buff_to_invoke = {<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*<span class="keyword">&gt;</span>(temp.data()) + <span class="keyword">sizeof</span>(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>), temp.<a class="code" href="../../d0/d87/classepee_1_1span.html#a6e69e80f2a8cf12c9b1df55c7d9618aa">size</a>() - <span class="keyword">sizeof</span>(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>)};</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          <span class="keywordtype">bool</span> is_response = (m_oponent_protocol_ver == <a class="code" href="../../d2/da4/levin__base_8h.html#a12433b8e4e6da9a447ed609690450fe3">LEVIN_PROTOCOL_VER_1</a> &amp;&amp; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">m_flags</a>&amp;<a class="code" href="../../d2/da4/levin__base_8h.html#a05934671a178c49b457228cc44ab7e3b">LEVIN_PACKET_RESPONSE</a>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;          MDEBUG(m_connection_context &lt;&lt; <span class="stringliteral">&quot;LEVIN_PACKET_RECEIVED. [len=&quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;, flags&quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">m_flags</a> </div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;, r?=&quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#af8ce8d9bfa19fe65939b7dd68c8ec906">m_have_to_return_data</a> </div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;, cmd = &quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a> </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;, v=&quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a094085ef90064a595ff6e04409e50d3f">m_protocol_version</a>);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          <span class="keywordflow">if</span>(is_response)</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          {<span class="comment">//response to some invoke </span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <a class="code" href="../../da/d04/classepee_1_1critical__region__t.html">epee::critical_region_t&lt;decltype(m_invoke_response_handlers_lock)&gt;</a> invoke_response_handlers_guard(m_invoke_response_handlers_lock);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keywordflow">if</span>(!m_invoke_response_handlers.empty())</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            {<span class="comment">//async call scenario</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              boost::shared_ptr&lt;invoke_response_handler_base&gt; response_handler = m_invoke_response_handlers.front();</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;              <span class="keywordtype">bool</span> timer_cancelled = response_handler-&gt;cancel_timer();</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;               <span class="comment">// Don&#39;t pop handler, to avoid destroying it</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;              <span class="keywordflow">if</span>(timer_cancelled)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                m_invoke_response_handlers.pop_front();</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;              invoke_response_handlers_guard.<a class="code" href="../../da/d04/classepee_1_1critical__region__t.html#a3ed2a784463c21759e000d88a5713df5">unlock</a>();</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;              <span class="keywordflow">if</span>(timer_cancelled)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                response_handler-&gt;handle(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#aca3b5dd204d1a0bc7b44261c6bb3529e">m_return_code</a>, buff_to_invoke, m_connection_context);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;              invoke_response_handlers_guard.<a class="code" href="../../da/d04/classepee_1_1critical__region__t.html#a3ed2a784463c21759e000d88a5713df5">unlock</a>();</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;              <span class="comment">//use sync call scenario</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;              <span class="keywordflow">if</span>(!m_wait_count &amp;&amp; !m_close_called)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;              {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                MERROR(m_connection_context &lt;&lt; <span class="stringliteral">&quot;no active invoke when response came, wtf?&quot;</span>);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;              }<span class="keywordflow">else</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;              {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <a class="code" href="../../d6/ded/syncobj_8h.html#adfcc7bf6d03ea34dbc9692a115c53da2">CRITICAL_REGION_BEGIN</a>(m_local_inv_buff_lock);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                m_local_inv_buff = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a5ca8a348395a6145775c1a2334e21889">std::string</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)buff_to_invoke.<a class="code" href="../../d0/d87/classepee_1_1span.html#af9959653eb0d2f90fefd449016b9e8c2">data</a>(), buff_to_invoke.<a class="code" href="../../d0/d87/classepee_1_1span.html#a6e69e80f2a8cf12c9b1df55c7d9618aa">size</a>());</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                buff_to_invoke = <a class="code" href="../../d0/d87/classepee_1_1span.html">epee::span&lt;const uint8_t&gt;</a>((<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)NULL, 0);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                m_invoke_result_code = m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#aca3b5dd204d1a0bc7b44261c6bb3529e">m_return_code</a>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                <a class="code" href="../../d6/ded/syncobj_8h.html#ac084672ad3029b635392dad8f94cd2de">CRITICAL_REGION_END</a>();</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                m_invoke_buf_ready = <span class="keyword">true</span>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;              }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            }</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;          }<span class="keywordflow">else</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordflow">if</span>(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#af8ce8d9bfa19fe65939b7dd68c8ec906">m_have_to_return_data</a>)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;              <a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html">levin::message_writer</a> return_message{32 * 1024};</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;              <span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> return_code = m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a511f8d81b68f7bf51d1d9148b9a080ba">m_pcommands_handler</a>-&gt;invoke(</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a>, buff_to_invoke, return_message.buffer, m_connection_context</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;              );</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;              <span class="comment">// peer_id remains unset if dropped</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;              <span class="keywordflow">if</span> (m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a> == m_connection_context.handshake_command() &amp;&amp; m_connection_context.handshake_complete())</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                m_max_packet_size = m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a559a37baaae8507544d8f21e5f872e9b">m_max_packet_size</a>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;              <span class="keywordflow">if</span>(!send_message(return_message.finalize_response(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a>, return_code)))</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;              m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a511f8d81b68f7bf51d1d9148b9a080ba">m_pcommands_handler</a>-&gt;notify(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a>, buff_to_invoke, m_connection_context);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;          }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;          <span class="comment">// reuse small buffer</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          <span class="keywordflow">if</span> (!temp.empty() &amp;&amp; temp.capacity() &lt;= 64 * 1024)</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            temp.clear();</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            m_fragment_buffer = <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#aa1114d84589bd22f45d443527528cb35">std::move</a>(temp);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">case</span> stream_state_head:</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;          <span class="keywordflow">if</span>(m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>() &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>))</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;          {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">if</span>(m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>() &gt;= <span class="keyword">sizeof</span>(<a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>) &amp;&amp; *((<a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>*)m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#adfce826deb76f4b0f7e022e764582572">span</a>(8).data()) != <a class="code" href="../../d5/d78/int-util_8h.html#a37afc8350a3a9f9744410844aaef518c">SWAP64LE</a>(<a class="code" href="../../d2/da4/levin__base_8h.html#ad5061c34dcae9e5512c060f2472fa1ae">LEVIN_SIGNATURE</a>))</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;              MWARNING(m_connection_context &lt;&lt; <span class="stringliteral">&quot;Signature mismatch, connection will be closed&quot;</span>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            is_continue = <span class="keyword">false</span>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="preprocessor">#if BYTE_ORDER == LITTLE_ENDIAN</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          <a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>&amp; phead = *(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>*)m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#adfce826deb76f4b0f7e022e764582572">span</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>)).data();</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          <a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a> phead = *(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>*)m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#adfce826deb76f4b0f7e022e764582572">span</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>)).data();</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#ae041c023a31e22a39edc006540cf5211">m_signature</a> = <a class="code" href="../../d5/d78/int-util_8h.html#a37afc8350a3a9f9744410844aaef518c">SWAP64LE</a>(phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#ae041c023a31e22a39edc006540cf5211">m_signature</a>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a> = <a class="code" href="../../d5/d78/int-util_8h.html#a37afc8350a3a9f9744410844aaef518c">SWAP64LE</a>(phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a>);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a> = <a class="code" href="../../d5/d78/int-util_8h.html#a51aa478627a7a7a2c63a84d838f95306">SWAP32LE</a>(phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a>);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#aca3b5dd204d1a0bc7b44261c6bb3529e">m_return_code</a> = <a class="code" href="../../d5/d78/int-util_8h.html#a51aa478627a7a7a2c63a84d838f95306">SWAP32LE</a>(phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#aca3b5dd204d1a0bc7b44261c6bb3529e">m_return_code</a>);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">m_flags</a> = <a class="code" href="../../d5/d78/int-util_8h.html#a51aa478627a7a7a2c63a84d838f95306">SWAP32LE</a>(phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">m_flags</a>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a094085ef90064a595ff6e04409e50d3f">m_protocol_version</a> = <a class="code" href="../../d5/d78/int-util_8h.html#a51aa478627a7a7a2c63a84d838f95306">SWAP32LE</a>(phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a094085ef90064a595ff6e04409e50d3f">m_protocol_version</a>);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../d2/da4/levin__base_8h.html#ad5061c34dcae9e5512c060f2472fa1ae">LEVIN_SIGNATURE</a> != phead.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#ae041c023a31e22a39edc006540cf5211">m_signature</a>)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;          {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <a class="code" href="../../de/de6/net__utils__base_8h.html#aaaf68851f429aeac8c9638ec082e8d7e">LOG_ERROR_CC</a>(m_connection_context, <span class="stringliteral">&quot;Signature mismatch, connection will be closed&quot;</span>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          m_current_head = phead;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a268f4731b273021b6514ba1cd852c3ab">erase</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">bucket_head2</a>));</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          m_state = stream_state_body;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          m_oponent_protocol_ver = m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a094085ef90064a595ff6e04409e50d3f">m_protocol_version</a>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">size_t</span> max_bytes = m_connection_context.get_max_bytes(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a>);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          <span class="keywordflow">if</span>(m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a> &gt; std::min&lt;size_t&gt;(max_packet_size, max_bytes))</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <a class="code" href="../../de/de6/net__utils__base_8h.html#aaaf68851f429aeac8c9638ec082e8d7e">LOG_ERROR_CC</a>(m_connection_context, <span class="stringliteral">&quot;Maximum packet size exceed!, m_max_packet_size = &quot;</span> &lt;&lt; std::min&lt;size_t&gt;(max_packet_size, max_bytes)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;, packet header received &quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">m_cb</a> &lt;&lt; <span class="stringliteral">&quot;, command &quot;</span> &lt;&lt; m_current_head.<a class="code" href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">m_command</a></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;, connection will be closed.&quot;</span>);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <a class="code" href="../../de/de6/net__utils__base_8h.html#aaaf68851f429aeac8c9638ec082e8d7e">LOG_ERROR_CC</a>(m_connection_context, <span class="stringliteral">&quot;Undefined state in levin_server_impl::connection_handler, m_state=&quot;</span> &lt;&lt; m_state);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a2bbb2b777052f5c5548e7f0901f14275">  620</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a2bbb2b777052f5c5548e7f0901f14275">after_init_connection</a>()</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">if</span> (!m_connection_initialized)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      m_connection_initialized = <span class="keyword">true</span>;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8fcaff270713d22805656eeb49b859b1">add_connection</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> callback_t&gt;</div><div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a2f8f009eb31de9696fcb23d47007b23b">  631</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a2f8f009eb31de9696fcb23d47007b23b">async_invoke</a>(<span class="keywordtype">int</span> command, <a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html">message_writer</a> in_msg, <span class="keyword">const</span> callback_t &amp;cb, <span class="keywordtype">size_t</span> timeout = <a class="code" href="../../d2/da4/levin__base_8h.html#adc3c0671eb36e04ca369816c36f21a1b">LEVIN_DEFAULT_TIMEOUT_PRECONFIGURED</a>)</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#a0b437906f4dc191bb47ae0d83739bc55">misc_utils::auto_scope_leave_caller</a> scope_exit_handler = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#ab69958a85696a5d3e6be09f424e3487c">misc_utils::create_scope_leave_handler</a>(</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      boost::bind(&amp;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">async_protocol_handler::finish_outer_call</a>, <span class="keyword">this</span>));</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span>(timeout == <a class="code" href="../../d2/da4/levin__base_8h.html#adc3c0671eb36e04ca369816c36f21a1b">LEVIN_DEFAULT_TIMEOUT_PRECONFIGURED</a>)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      timeout = m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a87447e1e73f8d89c189bf428b7f9ac4f">m_invoke_timeout</a>;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordtype">int</span> err_code = <a class="code" href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_call_lock);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      m_invoke_buf_ready = <span class="keyword">false</span>;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <a class="code" href="../../d6/ded/syncobj_8h.html#adfcc7bf6d03ea34dbc9692a115c53da2">CRITICAL_REGION_BEGIN</a>(m_invoke_response_handlers_lock);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">if</span> (command == m_connection_context.handshake_command())</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        m_max_packet_size = m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a559a37baaae8507544d8f21e5f872e9b">m_max_packet_size</a>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keywordflow">if</span>(!send_message(in_msg.<a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html#a1e7a5b4f176bf0fa58a688d16eab11ba">finalize_invoke</a>(command)))</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      {</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <a class="code" href="../../de/de6/net__utils__base_8h.html#aaaf68851f429aeac8c9638ec082e8d7e">LOG_ERROR_CC</a>(m_connection_context, <span class="stringliteral">&quot;Failed to do_send&quot;</span>);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        err_code = <a class="code" href="../../d2/da4/levin__base_8h.html#a1d9eddb66c14d27facb30fafdbca6eb0">LEVIN_ERROR_CONNECTION</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">if</span>(!add_invoke_response_handler(cb, timeout, *<span class="keyword">this</span>, command))</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        err_code = <a class="code" href="../../d2/da4/levin__base_8h.html#a9497e6e3132b6c55af7c4b2fc58c8554">LEVIN_ERROR_CONNECTION_DESTROYED</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <a class="code" href="../../d6/ded/syncobj_8h.html#ac084672ad3029b635392dad8f94cd2de">CRITICAL_REGION_END</a>();</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    } <span class="keywordflow">while</span> (<span class="keyword">false</span>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a> != err_code)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <a class="code" href="../../d0/d87/classepee_1_1span.html">epee::span&lt;const uint8_t&gt;</a> stub_buff = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="comment">// Never call callback inside critical section, that can cause deadlock</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      cb(err_code, stub_buff, m_connection_context);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad7bb4fe9382564d5212bceb0b107d487">  676</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad7bb4fe9382564d5212bceb0b107d487">invoke</a>(<span class="keywordtype">int</span> command, <a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html">message_writer</a> in_msg, <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a5ca8a348395a6145775c1a2334e21889">std::string</a>&amp; buff_out)</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#a0b437906f4dc191bb47ae0d83739bc55">misc_utils::auto_scope_leave_caller</a> scope_exit_handler = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#ab69958a85696a5d3e6be09f424e3487c">misc_utils::create_scope_leave_handler</a>(</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                      boost::bind(&amp;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">async_protocol_handler::finish_outer_call</a>, <span class="keyword">this</span>));</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_call_lock);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    m_invoke_buf_ready = <span class="keyword">false</span>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span> (command == m_connection_context.handshake_command())</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      m_max_packet_size = m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a559a37baaae8507544d8f21e5f872e9b">m_max_packet_size</a>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="../../d0/d74/signature_8cpp.html#a9200197b9c765b5e63983faaf4d96cf4">if</a> (!send_message(in_msg.<a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html#a1e7a5b4f176bf0fa58a688d16eab11ba">finalize_invoke</a>(command)))</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <a class="code" href="../../de/de6/net__utils__base_8h.html#aaaf68851f429aeac8c9638ec082e8d7e">LOG_ERROR_CC</a>(m_connection_context, <span class="stringliteral">&quot;Failed to send request&quot;</span>);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#a1d9eddb66c14d27facb30fafdbca6eb0">LEVIN_ERROR_CONNECTION</a>;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    }</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> ticks_start = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#a538f76de2cac6b8a8508931bc47dcb86">misc_utils::get_tick_count</a>();</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordtype">size_t</span> prev_size = 0;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">while</span>(!m_invoke_buf_ready &amp;&amp; !m_protocol_released)</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keywordflow">if</span>(m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>() - prev_size &gt;= <a class="code" href="../../db/d60/levin__protocol__handler__async_8h.html#abaa11629e632147eeac82dfaa5349ad2">MIN_BYTES_WANTED</a>)</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        prev_size = m_cache_in_buffer.<a class="code" href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">size</a>();</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        ticks_start = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#a538f76de2cac6b8a8508931bc47dcb86">misc_utils::get_tick_count</a>();</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      }</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#a538f76de2cac6b8a8508931bc47dcb86">misc_utils::get_tick_count</a>() - ticks_start &gt; m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a87447e1e73f8d89c189bf428b7f9ac4f">m_invoke_timeout</a>)</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        MWARNING(m_connection_context &lt;&lt; <span class="stringliteral">&quot;invoke timeout (&quot;</span> &lt;&lt; m_config.<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a87447e1e73f8d89c189bf428b7f9ac4f">m_invoke_timeout</a> &lt;&lt; <span class="stringliteral">&quot;), closing connection &quot;</span>);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9052ea623aafad44b54bd0da107c7d2c">close</a>();</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#ae958211ab5044e294951c38d03033d70">LEVIN_ERROR_CONNECTION_TIMEDOUT</a>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keywordflow">if</span>(!m_pservice_endpoint-&gt;<a class="code" href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#a5d90af9574b91f3e1f2ea90077ffea7e">call_run_once_service_io</a>())</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#a9497e6e3132b6c55af7c4b2fc58c8554">LEVIN_ERROR_CONNECTION_DESTROYED</a>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span>(m_protocol_released)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#a9497e6e3132b6c55af7c4b2fc58c8554">LEVIN_ERROR_CONNECTION_DESTROYED</a>;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="../../d6/ded/syncobj_8h.html#adfcc7bf6d03ea34dbc9692a115c53da2">CRITICAL_REGION_BEGIN</a>(m_local_inv_buff_lock);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    buff_out.swap(m_local_inv_buff);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    m_local_inv_buff.clear();</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="../../d6/ded/syncobj_8h.html#ac084672ad3029b635392dad8f94cd2de">CRITICAL_REGION_END</a>();</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">return</span> m_invoke_result_code;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a61ee2b210b302fd0453a6842b76cf130">  731</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a61ee2b210b302fd0453a6842b76cf130">send</a>(<a class="code" href="../../d0/d9e/classepee_1_1byte__slice.html">byte_slice</a> <a class="code" href="../../d6/dc2/namespacegtest__output__test.html#ac696d0798ad7d08cb2e61070824750e2">message</a>)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#a0b437906f4dc191bb47ae0d83739bc55">misc_utils::auto_scope_leave_caller</a> scope_exit_handler = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#ab69958a85696a5d3e6be09f424e3487c">misc_utils::create_scope_leave_handler</a>(</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      boost::bind(&amp;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">async_protocol_handler::finish_outer_call</a>, <span class="keyword">this</span>)</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    );</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (!send_message(<a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#aa1114d84589bd22f45d443527528cb35">std::move</a>(message)))</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <a class="code" href="../../de/de6/net__utils__base_8h.html#aaaf68851f429aeac8c9638ec082e8d7e">LOG_ERROR_CC</a>(m_connection_context, <span class="stringliteral">&quot;Failed to send message, dropping it&quot;</span>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  }</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00745"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abcee686a6e07280a830f6e51b2048af6">  745</a></span>&#160;  <a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abcee686a6e07280a830f6e51b2048af6">get_connection_id</a>() {<span class="keywordflow">return</span> m_connection_context.m_connection_id;}</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00747"></a><span class="lineno"><a class="line" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">  747</a></span>&#160;  t_connection_context&amp; <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">get_context_ref</a>() {<span class="keywordflow">return</span> m_connection_context;}</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;};</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00751"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#acbbb8de2208d86d282441ec01932cab5">  751</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#acbbb8de2208d86d282441ec01932cab5">async_protocol_handler_config&lt;t_connection_context&gt;::del_connection</a>(<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* pconn)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;{</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#adfcc7bf6d03ea34dbc9692a115c53da2">CRITICAL_REGION_BEGIN</a>(m_connects_lock);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  m_connects.erase(pconn-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abcee686a6e07280a830f6e51b2048af6">get_connection_id</a>());</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#ac084672ad3029b635392dad8f94cd2de">CRITICAL_REGION_END</a>();</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  m_pcommands_handler-&gt;<a class="code" href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html#a5d3cd8de621eb54af73e8871af47441c">on_connection_close</a>(pconn-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ab44fe47607db1b3159d015d5335c6b8a">m_connection_context</a>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;}</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00760"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a64079d8a3784b04ff0ee7c1a36b6bcd8">  760</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a64079d8a3784b04ff0ee7c1a36b6bcd8">async_protocol_handler_config&lt;t_connection_context&gt;::delete_connections</a>(<span class="keywordtype">size_t</span> <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>, <span class="keywordtype">bool</span> incoming)</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;{</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  std::vector&lt;typename connections_map::mapped_type&gt; <a class="code" href="../../d9/ded/namespacecryptonote_1_1levin.html#a95314ed712669cfd7cd26c33520c7864">connections</a>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keyword">auto</span> scope_exit_handler = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#ab69958a85696a5d3e6be09f424e3487c">misc_utils::create_scope_leave_handler</a>([&amp;connections]{</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;aph: connections)</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      aph-&gt;finish_outer_call();</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  });</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#adfcc7bf6d03ea34dbc9692a115c53da2">CRITICAL_REGION_BEGIN</a>(m_connects_lock);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2bce00014695ec26226c92abd4eccb9a">c</a>: m_connects)</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2bce00014695ec26226c92abd4eccb9a">c</a>.second-&gt;m_connection_context.m_is_income == incoming)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2bce00014695ec26226c92abd4eccb9a">c</a>.second-&gt;start_outer_call())</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        connections.push_back(<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2bce00014695ec26226c92abd4eccb9a">c</a>.second);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="comment">// close random connections from  the provided set</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="comment">// TODO or better just keep removing random elements (performance)</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="../../da/d36/code-generator_8cpp.html#ad41ea26c8e549ce5fef3c9e5df078f05">seed</a> = std::chrono::system_clock::now().time_since_epoch().count();</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  shuffle(connections.begin(), connections.end(), std::default_random_engine(seed));</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a> = 0; <a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a> &lt; connections.size() &amp;&amp; <a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a> &lt; <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>; ++<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a>)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    m_connects.erase(connections[<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a>]-&gt;get_connection_id());</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#ac084672ad3029b635392dad8f94cd2de">CRITICAL_REGION_END</a>();</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a> = 0; <a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a> &lt; connections.size() &amp;&amp; <a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a> &lt; <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>; ++<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a>)</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    connections[<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">i</a>]-&gt;<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9052ea623aafad44b54bd0da107c7d2c">close</a>();</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;}</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00791"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a81deb95abb05c9cecafabd662a4fe334">  791</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a81deb95abb05c9cecafabd662a4fe334">async_protocol_handler_config&lt;t_connection_context&gt;::del_out_connections</a>(<span class="keywordtype">size_t</span> <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;{</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a64079d8a3784b04ff0ee7c1a36b6bcd8">delete_connections</a>(count, <span class="keyword">false</span>);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;}</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00797"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a95a9ebf87aa9760c503fc607f24f88b6">  797</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a95a9ebf87aa9760c503fc607f24f88b6">async_protocol_handler_config&lt;t_connection_context&gt;::del_in_connections</a>(<span class="keywordtype">size_t</span> <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;{</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a64079d8a3784b04ff0ee7c1a36b6bcd8">delete_connections</a>(count, <span class="keyword">true</span>);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;}</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00803"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8fcaff270713d22805656eeb49b859b1">  803</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8fcaff270713d22805656eeb49b859b1">async_protocol_handler_config&lt;t_connection_context&gt;::add_connection</a>(<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* pconn)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;{</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#adfcc7bf6d03ea34dbc9692a115c53da2">CRITICAL_REGION_BEGIN</a>(m_connects_lock);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  m_connects[pconn-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abcee686a6e07280a830f6e51b2048af6">get_connection_id</a>()] = pconn;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#ac084672ad3029b635392dad8f94cd2de">CRITICAL_REGION_END</a>();</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  m_pcommands_handler-&gt;<a class="code" href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html#a32a8bfeff79c63a0defc76acc345bac3">on_connection_new</a>(pconn-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ab44fe47607db1b3159d015d5335c6b8a">m_connection_context</a>);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;}</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00812"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a2aefffdba133dc76afbe098d67e0aa65">  812</a></span>&#160;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a2aefffdba133dc76afbe098d67e0aa65">async_protocol_handler_config&lt;t_connection_context&gt;::find_connection</a>(<a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id)<span class="keyword"> const</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keyword">auto</span> it = m_connects.find(connection_id);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordflow">return</span> it == m_connects.end() ? 0 : it-&gt;second;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;}</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00819"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">  819</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">async_protocol_handler_config&lt;t_connection_context&gt;::find_and_lock_connection</a>(<a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id, <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>*&amp; aph)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;{</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_connects_lock);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  aph = <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a2aefffdba133dc76afbe098d67e0aa65">find_connection</a>(connection_id);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">if</span>(0 == aph)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#aa78a724b29fdb403463e461d1e0d89c2">LEVIN_ERROR_CONNECTION_NOT_FOUND</a>;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">if</span>(!aph-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ab3dbcfccfc8a62b02daf12706176cffc">start_outer_call</a>())</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#a9497e6e3132b6c55af7c4b2fc58c8554">LEVIN_ERROR_CONNECTION_DESTROYED</a>;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00831"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#ac059443ab409c3180b9281013f2359e6">  831</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#ac059443ab409c3180b9281013f2359e6">async_protocol_handler_config&lt;t_connection_context&gt;::invoke</a>(<span class="keywordtype">int</span> command, <a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html">message_writer</a> in_msg, <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#a5ca8a348395a6145775c1a2334e21889">std::string</a>&amp; buff_out, <a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;{</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* aph;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d2/d2c/namespacetestupnpigd.html#a2555af319ee046c7951ea9d78eb57724">r</a> = <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">find_and_lock_connection</a>(connection_id, aph);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a> == r ? aph-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad7bb4fe9382564d5212bceb0b107d487">invoke</a>(command, <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#aa1114d84589bd22f45d443527528cb35">std::move</a>(in_msg), buff_out) : <a class="code" href="../../d2/d2c/namespacetestupnpigd.html#a2555af319ee046c7951ea9d78eb57724">r</a>;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;}</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt; <span class="keyword">template</span>&lt;<span class="keyword">class</span> callback_t&gt;</div><div class="line"><a name="l00839"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#ac6eb706056fcad88cd35b67d850378d8">  839</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#ac6eb706056fcad88cd35b67d850378d8">async_protocol_handler_config&lt;t_connection_context&gt;::invoke_async</a>(<span class="keywordtype">int</span> command, <a class="code" href="../../dc/d26/classepee_1_1levin_1_1message__writer.html">message_writer</a> in_msg, <a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id, <span class="keyword">const</span> callback_t &amp;cb, <span class="keywordtype">size_t</span> timeout)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;{</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* aph;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d2/d2c/namespacetestupnpigd.html#a2555af319ee046c7951ea9d78eb57724">r</a> = <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">find_and_lock_connection</a>(connection_id, aph);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a> == r ? aph-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a2f8f009eb31de9696fcb23d47007b23b">async_invoke</a>(command, <a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#aa1114d84589bd22f45d443527528cb35">std::move</a>(in_msg), cb, timeout) : <a class="code" href="../../d2/d2c/namespacetestupnpigd.html#a2555af319ee046c7951ea9d78eb57724">r</a>;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;}</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt; <span class="keyword">template</span>&lt;<span class="keyword">class</span> callback_t&gt;</div><div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a4a41b55917e89104e2d65400b5849786">  847</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a4a41b55917e89104e2d65400b5849786">async_protocol_handler_config&lt;t_connection_context&gt;::foreach_connection</a>(<span class="keyword">const</span> callback_t &amp;cb)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;{</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  std::vector&lt;typename connections_map::mapped_type&gt; <a class="code" href="../../df/dd9/fuzz_2levin_8cpp.html#a5792c2d0c3d746ccfd5f938436c42951">conn</a>;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keyword">auto</span> scope_exit_handler = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#ab69958a85696a5d3e6be09f424e3487c">misc_utils::create_scope_leave_handler</a>([&amp;conn]{</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;aph: conn)</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      aph-&gt;finish_outer_call();</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  });</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#adfcc7bf6d03ea34dbc9692a115c53da2">CRITICAL_REGION_BEGIN</a>(m_connects_lock);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  conn.reserve(m_connects.size());</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="../../d5/dd5/namespacepymoduletest.html#ab2f9c86c48b23e2100d0574cbc00c5b0">e</a>: m_connects)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd5/namespacepymoduletest.html#ab2f9c86c48b23e2100d0574cbc00c5b0">e</a>.second-&gt;start_outer_call())</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      conn.push_back(<a class="code" href="../../d5/dd5/namespacepymoduletest.html#ab2f9c86c48b23e2100d0574cbc00c5b0">e</a>.second);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#ac084672ad3029b635392dad8f94cd2de">CRITICAL_REGION_END</a>()</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;aph: conn)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">if</span> (!cb(aph-&gt;get_context_ref()))</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;}</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt; <span class="keyword">template</span>&lt;<span class="keyword">class</span> callback_t&gt;</div><div class="line"><a name="l00871"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a4046568fefb64f4ef1ee07d7c86f573c">  871</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a4046568fefb64f4ef1ee07d7c86f573c">async_protocol_handler_config&lt;t_connection_context&gt;::for_connection</a>(<span class="keyword">const</span> <a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> &amp;connection_id, <span class="keyword">const</span> callback_t &amp;cb)</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;{</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* aph = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">find_and_lock_connection</a>(connection_id, aph) != <a class="code" href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a>)</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keyword">auto</span> scope_exit_handler = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#ab69958a85696a5d3e6be09f424e3487c">misc_utils::create_scope_leave_handler</a>(</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    boost::bind(&amp;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;::finish_outer_call</a>, aph));</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">if</span>(!cb(aph-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">get_context_ref</a>()))</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;}</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a100e213bf9e527a15f529eca1cb248f3">  884</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a100e213bf9e527a15f529eca1cb248f3">async_protocol_handler_config&lt;t_connection_context&gt;::get_connections_count</a>()</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;{</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_connects_lock);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">return</span> m_connects.size();</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;}</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00891"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9238187db44e261baafc2dfccaa460d4">  891</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9238187db44e261baafc2dfccaa460d4">async_protocol_handler_config&lt;t_connection_context&gt;::get_out_connections_count</a>()</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;{</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_connects_lock);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = 0;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2bce00014695ec26226c92abd4eccb9a">c</a>: m_connects)</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2bce00014695ec26226c92abd4eccb9a">c</a>.second-&gt;m_connection_context.m_is_income)</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      ++<a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;}</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00902"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#aeab87b0a2a3b936e5aa2d3860544715b">  902</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#aeab87b0a2a3b936e5aa2d3860544715b">async_protocol_handler_config&lt;t_connection_context&gt;::get_in_connections_count</a>()</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;{</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_connects_lock);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = 0;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2bce00014695ec26226c92abd4eccb9a">c</a>: m_connects)</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd5/namespacepymoduletest.html#a2bce00014695ec26226c92abd4eccb9a">c</a>.second-&gt;m_connection_context.m_is_income)</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      ++<a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;}</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00913"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a83046603800352cae8978c26b4f823c9">  913</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a83046603800352cae8978c26b4f823c9">async_protocol_handler_config&lt;t_connection_context&gt;::set_handler</a>(<a class="code" href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html">levin_commands_handler&lt;t_connection_context&gt;</a>* handler, <span class="keywordtype">void</span> (*destroy)(<a class="code" href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html">levin_commands_handler&lt;t_connection_context&gt;</a>*))</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;{</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">if</span> (m_pcommands_handler &amp;&amp; <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a343a368e7a9b7ff8bdebd713b45bbef0">m_pcommands_handler_destroy</a>)</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    (*m_pcommands_handler_destroy)(<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a511f8d81b68f7bf51d1d9148b9a080ba">m_pcommands_handler</a>);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  m_pcommands_handler = handler;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a343a368e7a9b7ff8bdebd713b45bbef0">m_pcommands_handler_destroy</a> = destroy;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;}</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00922"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a5261b7c947b0457b1f9bf262590a6612">  922</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a5261b7c947b0457b1f9bf262590a6612">async_protocol_handler_config&lt;t_connection_context&gt;::send</a>(<a class="code" href="../../d0/d9e/classepee_1_1byte__slice.html">byte_slice</a> <a class="code" href="../../d6/dc2/namespacegtest__output__test.html#ac696d0798ad7d08cb2e61070824750e2">message</a>, <span class="keyword">const</span> <a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a>&amp; connection_id)</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;{</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* aph;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d2/d2c/namespacetestupnpigd.html#a2555af319ee046c7951ea9d78eb57724">r</a> = <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">find_and_lock_connection</a>(connection_id, aph);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a> == r ? aph-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a61ee2b210b302fd0453a6842b76cf130">send</a>(<a class="code" href="../../d0/da7/namespacetesting_1_1internal.html#aa1114d84589bd22f45d443527528cb35">std::move</a>(message)) : 0;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;}</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00930"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9052ea623aafad44b54bd0da107c7d2c">  930</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9052ea623aafad44b54bd0da107c7d2c">async_protocol_handler_config&lt;t_connection_context&gt;::close</a>(<a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;{</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* aph = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">find_and_lock_connection</a>(connection_id, aph) != <a class="code" href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a>)</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keyword">auto</span> scope_exit_handler = <a class="code" href="../../da/dcf/namespaceepee_1_1misc__utils.html#ab69958a85696a5d3e6be09f424e3487c">misc_utils::create_scope_leave_handler</a>(</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    boost::bind(&amp;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;::finish_outer_call</a>, aph));</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="keywordflow">if</span> (!aph-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a4ddeb783e06601e3af44798339257b15">close</a>())</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_connects_lock);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  m_connects.erase(connection_id);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00945"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8798dd25f119812f631a56366a4c2f3e">  945</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8798dd25f119812f631a56366a4c2f3e">async_protocol_handler_config&lt;t_connection_context&gt;::update_connection_context</a>(<span class="keyword">const</span> t_connection_context&amp; contxt)</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;{</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="code" href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a>(m_connects_lock);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* aph = <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a2aefffdba133dc76afbe098d67e0aa65">find_connection</a>(contxt.m_connection_id);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordflow">if</span>(0 == aph)</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  aph-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a533976eb424aff6ac1002cb39b87033d">update_connection_context</a>(contxt);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;}</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> t_connection_context&gt;</div><div class="line"><a name="l00956"></a><span class="lineno"><a class="line" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a064b3846f4ea1942cbd26c78c342575d">  956</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a064b3846f4ea1942cbd26c78c342575d">async_protocol_handler_config&lt;t_connection_context&gt;::request_callback</a>(<a class="code" href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">boost::uuids::uuid</a> connection_id)</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;{</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">async_protocol_handler&lt;t_connection_context&gt;</a>* aph;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d2/d2c/namespacetestupnpigd.html#a2555af319ee046c7951ea9d78eb57724">r</a> = <a class="code" href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">find_and_lock_connection</a>(connection_id, aph);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a> == r)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    aph-&gt;<a class="code" href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a5628fd6257bcc237565912271a848485">request_callback</a>();</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;}</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;}</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;}</div><div class="ttc" id="hmac__keccak_8cpp_html_ab4fd73a44e0cd1bee88072b7e02d8b7c"><div class="ttname"><a href="../../df/d8f/hmac__keccak_8cpp.html#ab4fd73a44e0cd1bee88072b7e02d8b7c">res</a></div><div class="ttdeci">const char * res</div><div class="ttdef"><b>Definition:</b> hmac_keccak.cpp:42</div></div>
<div class="ttc" id="levin__base_8h_html_ae958211ab5044e294951c38d03033d70"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#ae958211ab5044e294951c38d03033d70">LEVIN_ERROR_CONNECTION_TIMEDOUT</a></div><div class="ttdeci">#define LEVIN_ERROR_CONNECTION_TIMEDOUT</div><div class="ttdef"><b>Definition:</b> levin_base.h:106</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_aad90321d53de3e88730efa55c96239b9afd107b79ac6160239ae422705c232abb"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aad90321d53de3e88730efa55c96239b9afd107b79ac6160239ae422705c232abb">epee::levin::async_protocol_handler::stream_state_head</a></div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:163</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_af6d9aa3e695273337aa11df2b80e1398"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af6d9aa3e695273337aa11df2b80e1398">epee::levin::async_protocol_handler::m_close_called</a></div><div class="ttdeci">std::atomic&lt; uint32_t &gt; m_close_called</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:178</div></div>
<div class="ttc" id="classepee_1_1net__utils_1_1buffer_html_ab0c17f92d3295e90b085e261ca2273c0"><div class="ttname"><a href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#ab0c17f92d3295e90b085e261ca2273c0">epee::net_utils::buffer::append</a></div><div class="ttdeci">void append(const void *data, size_t sz)</div><div class="ttdef"><b>Definition:</b> buffer.cpp:42</div></div>
<div class="ttc" id="levin__base_8h_html_ad5061c34dcae9e5512c060f2472fa1ae"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#ad5061c34dcae9e5512c060f2472fa1ae">LEVIN_SIGNATURE</a></div><div class="ttdeci">#define LEVIN_SIGNATURE</div><div class="ttdef"><b>Definition:</b> levin_base.h:38</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a3ac55b4bbc94549be37fd8b63b91e7ec"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a3ac55b4bbc94549be37fd8b63b91e7ec">epee::levin::async_protocol_handler::m_pservice_endpoint</a></div><div class="ttdeci">net_utils::i_service_endpoint * m_pservice_endpoint</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:180</div></div>
<div class="ttc" id="structepee_1_1levin_1_1bucket__head2_html_a094085ef90064a595ff6e04409e50d3f"><div class="ttname"><a href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a094085ef90064a595ff6e04409e50d3f">epee::levin::bucket_head2::m_protocol_version</a></div><div class="ttdeci">uint32_t m_protocol_version</div><div class="ttdef"><b>Definition:</b> levin_base.h:70</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a549bf87686bfdf473b44b0d2c9fadcb8"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a549bf87686bfdf473b44b0d2c9fadcb8">epee::levin::async_protocol_handler_config::connections_map</a></div><div class="ttdeci">boost::unordered_map&lt; boost::uuids::uuid, async_protocol_handler&lt; t_connection_context &gt; *&gt; connections_map</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:82</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_abe92ac2f6babec8692c49ee46e033488"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abe92ac2f6babec8692c49ee46e033488">epee::levin::async_protocol_handler::config_type</a></div><div class="ttdeci">async_protocol_handler_config&lt; t_connection_context &gt; config_type</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:159</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_abc827c6a4c19fe6eb0eefa64c6a682ab"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abc827c6a4c19fe6eb0eefa64c6a682ab">epee::levin::async_protocol_handler::m_config</a></div><div class="ttdeci">config_type &amp; m_config</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:181</div></div>
<div class="ttc" id="namespaceepee_1_1misc__utils_html_a538f76de2cac6b8a8508931bc47dcb86"><div class="ttname"><a href="../../da/dcf/namespaceepee_1_1misc__utils.html#a538f76de2cac6b8a8508931bc47dcb86">epee::misc_utils::get_tick_count</a></div><div class="ttdeci">uint64_t get_tick_count()</div><div class="ttdef"><b>Definition:</b> time_helper.h:82</div></div>
<div class="ttc" id="gmock__stress__test_8cc_html_afd9db40e3361ae09188795e8cbe19752"><div class="ttname"><a href="../../da/d1d/gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a></div><div class="ttdeci">int * count</div><div class="ttdef"><b>Definition:</b> gmock_stress_test.cc:176</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a3dd3b8d3d0bd546fc90c6e18529012f1"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a3dd3b8d3d0bd546fc90c6e18529012f1">epee::levin::async_protocol_handler::m_invoke_response_handlers_lock</a></div><div class="ttdeci">critical_section m_invoke_response_handlers_lock</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:287</div></div>
<div class="ttc" id="namespacepymoduletest_html_a2c17f82375a6691bffaa1927a2247b28"><div class="ttname"><a href="../../d5/dd5/namespacepymoduletest.html#a2c17f82375a6691bffaa1927a2247b28">pymoduletest.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> pymoduletest.py:23</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a8de11cd1fbdc31b72d869dbf598af25b"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a8de11cd1fbdc31b72d869dbf598af25b">epee::levin::async_protocol_handler::m_connection_initialized</a></div><div class="ttdeci">bool m_connection_initialized</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:189</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a511f8d81b68f7bf51d1d9148b9a080ba"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a511f8d81b68f7bf51d1d9148b9a080ba">epee::levin::async_protocol_handler_config::m_pcommands_handler</a></div><div class="ttdeci">levin_commands_handler&lt; t_connection_context &gt; * m_pcommands_handler</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:94</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_a570039c44ea723cb6e347ba763ef9139"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a570039c44ea723cb6e347ba763ef9139">epee::levin::async_protocol_handler::anvoke_handler::m_timeout</a></div><div class="ttdeci">uint64_t m_timeout</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:231</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_aad90321d53de3e88730efa55c96239b9"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aad90321d53de3e88730efa55c96239b9">epee::levin::async_protocol_handler::stream_state</a></div><div class="ttdeci">stream_state</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:161</div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a5ca8a348395a6145775c1a2334e21889"><div class="ttname"><a href="../../d0/da7/namespacetesting_1_1internal.html#a5ca8a348395a6145775c1a2334e21889">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> gtest-port.h:1097</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a6250c0ea64875d182f6584cadecc788b"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a6250c0ea64875d182f6584cadecc788b">epee::levin::async_protocol_handler_config::connection_context</a></div><div class="ttdeci">t_connection_context connection_context</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:100</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a02e983647e496f39159fd4eb3b0dd409"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a02e983647e496f39159fd4eb3b0dd409">epee::levin::async_protocol_handler::send_message</a></div><div class="ttdeci">bool send_message(byte_slice message)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:138</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_a9d4351caa3ef1771873dcaf7825af8f7"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a9d4351caa3ef1771873dcaf7825af8f7">epee::levin::async_protocol_handler::anvoke_handler::anvoke_handler</a></div><div class="ttdeci">anvoke_handler(const callback_t &amp;cb, uint64_t timeout, async_protocol_handler &amp;con, int command)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:202</div></div>
<div class="ttc" id="levin__base_8h_html_a590aba0578116971f9711a9f9d097835"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#a590aba0578116971f9711a9f9d097835">LEVIN_PACKET_REQUEST</a></div><div class="ttdeci">#define LEVIN_PACKET_REQUEST</div><div class="ttdef"><b>Definition:</b> levin_base.h:79</div></div>
<div class="ttc" id="namespaceepee_1_1misc__utils_html_ab69958a85696a5d3e6be09f424e3487c"><div class="ttname"><a href="../../da/dcf/namespaceepee_1_1misc__utils.html#ab69958a85696a5d3e6be09f424e3487c">epee::misc_utils::create_scope_leave_handler</a></div><div class="ttdeci">auto_scope_leave_caller create_scope_leave_handler(t_scope_leave_handler f)</div><div class="ttdef"><b>Definition:</b> misc_language.h:97</div></div>
<div class="ttc" id="structepee_1_1levin_1_1bucket__head2_html_a983b0d40100046e6655a362eb7dcb8a9"><div class="ttname"><a href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a983b0d40100046e6655a362eb7dcb8a9">epee::levin::bucket_head2::m_cb</a></div><div class="ttdeci">uint64_t m_cb</div><div class="ttdef"><b>Definition:</b> levin_base.h:65</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a054a9fe3bf3051813ef8d0e241c4653d"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a054a9fe3bf3051813ef8d0e241c4653d">epee::levin::async_protocol_handler::m_wait_count</a></div><div class="ttdeci">std::atomic&lt; uint32_t &gt; m_wait_count</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:177</div></div>
<div class="ttc" id="syncobj_8h_html"><div class="ttname"><a href="../../d6/ded/syncobj_8h.html">syncobj.h</a></div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_a310e632d8f7e30ee594442940f4cf096"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a310e632d8f7e30ee594442940f4cf096">epee::levin::async_protocol_handler::anvoke_handler::m_timer_started</a></div><div class="ttdeci">bool m_timer_started</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:228</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a8868445ae3885a65ed30130bdd3ba5a8"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8868445ae3885a65ed30130bdd3ba5a8">epee::levin::async_protocol_handler_config::m_connects_lock</a></div><div class="ttdeci">critical_section m_connects_lock</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:83</div></div>
<div class="ttc" id="levin__base_8h_html_a05934671a178c49b457228cc44ab7e3b"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#a05934671a178c49b457228cc44ab7e3b">LEVIN_PACKET_RESPONSE</a></div><div class="ttdeci">#define LEVIN_PACKET_RESPONSE</div><div class="ttdef"><b>Definition:</b> levin_base.h:80</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_a686b31062d3899b129005f4d45ca9c4f"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a686b31062d3899b129005f4d45ca9c4f">epee::levin::async_protocol_handler::anvoke_handler::cancel</a></div><div class="ttdeci">virtual void cancel()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:245</div></div>
<div class="ttc" id="levin__protocol__handler__async_8h_html_abaa11629e632147eeac82dfaa5349ad2"><div class="ttname"><a href="../../db/d60/levin__protocol__handler__async_8h.html#abaa11629e632147eeac82dfaa5349ad2">MIN_BYTES_WANTED</a></div><div class="ttdeci">#define MIN_BYTES_WANTED</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:50</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_aafa934af083f78f578f042a6dbfb93d2"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#aafa934af083f78f578f042a6dbfb93d2">epee::levin::async_protocol_handler::anvoke_handler::m_command</a></div><div class="ttdeci">int m_command</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:232</div></div>
<div class="ttc" id="structepee_1_1levin_1_1bucket__head2_html_a0b0169d1ab62cd6c68c24408e896d998"><div class="ttname"><a href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a0b0169d1ab62cd6c68c24408e896d998">epee::levin::bucket_head2::m_flags</a></div><div class="ttdeci">uint32_t m_flags</div><div class="ttdef"><b>Definition:</b> levin_base.h:69</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a559a37baaae8507544d8f21e5f872e9b"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a559a37baaae8507544d8f21e5f872e9b">epee::levin::async_protocol_handler_config::m_max_packet_size</a></div><div class="ttdeci">uint64_t m_max_packet_size</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:102</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a01a7fd533a073d3b7e42d54a8559971b"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a01a7fd533a073d3b7e42d54a8559971b">epee::levin::async_protocol_handler::m_local_inv_buff</a></div><div class="ttdeci">std::string m_local_inv_buff</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:173</div></div>
<div class="ttc" id="classepee_1_1byte__slice_html_aa04dda0b9f60d823c76b034467faebe3"><div class="ttname"><a href="../../d0/d9e/classepee_1_1byte__slice.html#aa04dda0b9f60d823c76b034467faebe3">epee::byte_slice::size</a></div><div class="ttdeci">std::size_t size() const noexcept</div><div class="ttdef"><b>Definition:</b> byte_slice.h:134</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a5f796258eda9a321ed5a528fc5149da5"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a5f796258eda9a321ed5a528fc5149da5">epee::levin::async_protocol_handler::m_local_inv_buff_lock</a></div><div class="ttdeci">critical_section m_local_inv_buff_lock</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:172</div></div>
<div class="ttc" id="classepee_1_1net__utils_1_1buffer_html_a268f4731b273021b6514ba1cd852c3ab"><div class="ttname"><a href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a268f4731b273021b6514ba1cd852c3ab">epee::net_utils::buffer::erase</a></div><div class="ttdeci">void erase(size_t sz)</div><div class="ttdef"><b>Definition:</b> buffer.h:52</div></div>
<div class="ttc" id="namespaceconfig_html"><div class="ttname"><a href="../../d6/d7f/namespaceconfig.html">config</a></div><div class="ttdef"><b>Definition:</b> cryptonote_config.h:215</div></div>
<div class="ttc" id="classepee_1_1span_html"><div class="ttname"><a href="../../d0/d87/classepee_1_1span.html">epee::span</a></div><div class="ttdoc">Non-owning sequence of data. Does not deep copy. </div><div class="ttdef"><b>Definition:</b> span.h:54</div></div>
<div class="ttc" id="time__helper_8h_html"><div class="ttname"><a href="../../d7/dba/time__helper_8h.html">time_helper.h</a></div></div>
<div class="ttc" id="structepee_1_1levin_1_1bucket__head2_html_ae041c023a31e22a39edc006540cf5211"><div class="ttname"><a href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#ae041c023a31e22a39edc006540cf5211">epee::levin::bucket_head2::m_signature</a></div><div class="ttdeci">uint64_t m_signature</div><div class="ttdef"><b>Definition:</b> levin_base.h:64</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a5261b7c947b0457b1f9bf262590a6612"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a5261b7c947b0457b1f9bf262590a6612">epee::levin::async_protocol_handler_config::send</a></div><div class="ttdeci">int send(epee::byte_slice message, const boost::uuids::uuid &amp;connection_id)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:922</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a36b76e290bc759412a876ffa2c1f4fe4"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a36b76e290bc759412a876ffa2c1f4fe4">epee::levin::async_protocol_handler::add_invoke_response_handler</a></div><div class="ttdeci">bool add_invoke_response_handler(const callback_t &amp;cb, uint64_t timeout, async_protocol_handler &amp;con, int command)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:291</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_ad4aaf4690161cdb29dbbd207df261a9d"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4aaf4690161cdb29dbbd207df261a9d">epee::levin::async_protocol_handler::m_protocol_released</a></div><div class="ttdeci">std::atomic&lt; bool &gt; m_protocol_released</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:167</div></div>
<div class="ttc" id="stdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> stdint.h:124</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a0efb2a425fa24b034004cbcf5f8e4666"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a0efb2a425fa24b034004cbcf5f8e4666">epee::levin::async_protocol_handler_config::~async_protocol_handler_config</a></div><div class="ttdeci">~async_protocol_handler_config()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:124</div></div>
<div class="ttc" id="classepee_1_1levin_1_1message__writer_html"><div class="ttname"><a href="../../dc/d26/classepee_1_1levin_1_1message__writer.html">epee::levin::message_writer</a></div><div class="ttdoc">Provides space for levin (p2p) header, so that payload can be sent without copy. </div><div class="ttdef"><b>Definition:</b> levin_base.h:131</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a100e213bf9e527a15f529eca1cb248f3"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a100e213bf9e527a15f529eca1cb248f3">epee::levin::async_protocol_handler_config::get_connections_count</a></div><div class="ttdeci">size_t get_connections_count()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:884</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a2bbb2b777052f5c5548e7f0901f14275"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a2bbb2b777052f5c5548e7f0901f14275">epee::levin::async_protocol_handler::after_init_connection</a></div><div class="ttdeci">bool after_init_connection()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:620</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_ac66fdfc8b515eb7749a293b0a8244b83"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ac66fdfc8b515eb7749a293b0a8244b83">epee::levin::async_protocol_handler::async_protocol_handler</a></div><div class="ttdeci">async_protocol_handler(net_utils::i_service_endpoint *psnd_hndlr, config_type &amp;config, t_connection_context &amp;conn_context)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:305</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_aca2dd292de4f81ad5ca799d308622f5e"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#aca2dd292de4f81ad5ca799d308622f5e">epee::levin::async_protocol_handler::m_cache_in_buffer</a></div><div class="ttdeci">net_utils::buffer m_cache_in_buffer</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:185</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a38462fe3565a1611ced14a02dbfe614e"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a38462fe3565a1611ced14a02dbfe614e">epee::levin::async_protocol_handler::m_max_packet_size</a></div><div class="ttdeci">std::atomic&lt; uint64_t &gt; m_max_packet_size</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:183</div></div>
<div class="ttc" id="structepee_1_1levin_1_1bucket__head2_html_aca3b5dd204d1a0bc7b44261c6bb3529e"><div class="ttname"><a href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#aca3b5dd204d1a0bc7b44261c6bb3529e">epee::levin::bucket_head2::m_return_code</a></div><div class="ttdeci">int32_t m_return_code</div><div class="ttdef"><b>Definition:</b> levin_base.h:68</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a5628fd6257bcc237565912271a848485"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a5628fd6257bcc237565912271a848485">epee::levin::async_protocol_handler::request_callback</a></div><div class="ttdeci">void request_callback()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:395</div></div>
<div class="ttc" id="syncobj_8h_html_ac084672ad3029b635392dad8f94cd2de"><div class="ttname"><a href="../../d6/ded/syncobj_8h.html#ac084672ad3029b635392dad8f94cd2de">CRITICAL_REGION_END</a></div><div class="ttdeci">#define CRITICAL_REGION_END()</div><div class="ttdef"><b>Definition:</b> syncobj.h:158</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_ac6eb706056fcad88cd35b67d850378d8"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#ac6eb706056fcad88cd35b67d850378d8">epee::levin::async_protocol_handler_config::invoke_async</a></div><div class="ttdeci">int invoke_async(int command, message_writer in_msg, boost::uuids::uuid connection_id, const callback_t &amp;cb, size_t timeout=LEVIN_DEFAULT_TIMEOUT_PRECONFIGURED)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:839</div></div>
<div class="ttc" id="levin__base_8h_html_a6d318750e44a88f864d4bca373448098"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#a6d318750e44a88f864d4bca373448098">LEVIN_DEFAULT_MAX_PACKET_SIZE</a></div><div class="ttdeci">#define LEVIN_DEFAULT_MAX_PACKET_SIZE</div><div class="ttdef"><b>Definition:</b> levin_base.h:77</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_ab44fe47607db1b3159d015d5335c6b8a"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ab44fe47607db1b3159d015d5335c6b8a">epee::levin::async_protocol_handler::m_connection_context</a></div><div class="ttdeci">t_connection_context &amp; m_connection_context</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:182</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_aa418f5701bfe66bafe945684cec26775"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#aa418f5701bfe66bafe945684cec26775">epee::levin::async_protocol_handler::anvoke_handler::is_timer_started</a></div><div class="ttdeci">virtual bool is_timer_started() const</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:241</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a4ddeb783e06601e3af44798339257b15"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a4ddeb783e06601e3af44798339257b15">epee::levin::async_protocol_handler::close</a></div><div class="ttdeci">bool close()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:382</div></div>
<div class="ttc" id="levin__base_8h_html"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html">levin_base.h</a></div></div>
<div class="ttc" id="classepee_1_1span_html_a6e69e80f2a8cf12c9b1df55c7d9618aa"><div class="ttname"><a href="../../d0/d87/classepee_1_1span.html#a6e69e80f2a8cf12c9b1df55c7d9618aa">epee::span::size</a></div><div class="ttdeci">constexpr std::size_t size() const noexcept</div><div class="ttdef"><b>Definition:</b> span.h:109</div></div>
<div class="ttc" id="namespacepymoduletest_html_ab2f9c86c48b23e2100d0574cbc00c5b0"><div class="ttname"><a href="../../d5/dd5/namespacepymoduletest.html#ab2f9c86c48b23e2100d0574cbc00c5b0">pymoduletest.e</a></div><div class="ttdeci">e</div><div class="ttdef"><b>Definition:</b> pymoduletest.py:79</div></div>
<div class="ttc" id="structepee_1_1net__utils_1_1i__service__endpoint_html_a679e32d0a9eb0fd78528b87b8db8fd4d"><div class="ttname"><a href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#a679e32d0a9eb0fd78528b87b8db8fd4d">epee::net_utils::i_service_endpoint::release</a></div><div class="ttdeci">virtual bool release()=0</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a288756f027b6998e2c33c3e8931ef0ae"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a288756f027b6998e2c33c3e8931ef0ae">epee::levin::async_protocol_handler_config::find_and_lock_connection</a></div><div class="ttdeci">int find_and_lock_connection(boost::uuids::uuid connection_id, async_protocol_handler&lt; t_connection_context &gt; *&amp;aph)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:819</div></div>
<div class="ttc" id="structepee_1_1levin_1_1bucket__head2_html"><div class="ttname"><a href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html">epee::levin::bucket_head2</a></div><div class="ttdef"><b>Definition:</b> levin_base.h:62</div></div>
<div class="ttc" id="levin__protocol__handler__async_8h_html_afaaddc4280dc2b4c337176832e428048"><div class="ttname"><a href="../../db/d60/levin__protocol__handler__async_8h.html#afaaddc4280dc2b4c337176832e428048">on_levin_traffic</a></div><div class="ttdeci">void on_levin_traffic(const context_t &amp;context, bool initiator, bool sent, bool error, size_t bytes, const char *category)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:54</div></div>
<div class="ttc" id="classepee_1_1net__utils_1_1buffer_html_a477b403134c3ff4002cf112705f2bbd2"><div class="ttname"><a href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#a477b403134c3ff4002cf112705f2bbd2">epee::net_utils::buffer::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> buffer.h:56</div></div>
<div class="ttc" id="classepee_1_1critical__section_html"><div class="ttname"><a href="../../df/d71/classepee_1_1critical__section.html">epee::critical_section</a></div><div class="ttdef"><b>Definition:</b> syncobj.h:81</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_ab3dbcfccfc8a62b02daf12706176cffc"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ab3dbcfccfc8a62b02daf12706176cffc">epee::levin::async_protocol_handler::start_outer_call</a></div><div class="ttdeci">bool start_outer_call()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:346</div></div>
<div class="ttc" id="structepee_1_1net__utils_1_1i__service__endpoint_html_ae038820c93497baa197ef836f0eeacb0"><div class="ttname"><a href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#ae038820c93497baa197ef836f0eeacb0">epee::net_utils::i_service_endpoint::add_ref</a></div><div class="ttdeci">virtual bool add_ref()=0</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a89702fd14fc0d7548c1d297ecbb6f7e8"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a89702fd14fc0d7548c1d297ecbb6f7e8">epee::levin::async_protocol_handler::m_invoke_response_handlers</a></div><div class="ttdeci">std::list&lt; boost::shared_ptr&lt; invoke_response_handler_base &gt; &gt; m_invoke_response_handlers</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:288</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_a5ae134a1c84b424ee042e9bd3bb9ad3b"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a5ae134a1c84b424ee042e9bd3bb9ad3b">epee::levin::async_protocol_handler::anvoke_handler::handle</a></div><div class="ttdeci">virtual bool handle(int res, const epee::span&lt; const uint8_t &gt; buff, typename async_protocol_handler::connection_context &amp;context)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:233</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a9238187db44e261baafc2dfccaa460d4"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9238187db44e261baafc2dfccaa460d4">epee::levin::async_protocol_handler_config::get_out_connections_count</a></div><div class="ttdeci">size_t get_out_connections_count()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:891</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a064b3846f4ea1942cbd26c78c342575d"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a064b3846f4ea1942cbd26c78c342575d">epee::levin::async_protocol_handler_config::request_callback</a></div><div class="ttdeci">bool request_callback(boost::uuids::uuid connection_id)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:956</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_ac059443ab409c3180b9281013f2359e6"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#ac059443ab409c3180b9281013f2359e6">epee::levin::async_protocol_handler_config::invoke</a></div><div class="ttdeci">int invoke(int command, message_writer in_msg, std::string &amp;buff_out, boost::uuids::uuid connection_id)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:831</div></div>
<div class="ttc" id="namespacecryptonote_1_1levin_html_a95314ed712669cfd7cd26c33520c7864"><div class="ttname"><a href="../../d9/ded/namespacecryptonote_1_1levin.html#a95314ed712669cfd7cd26c33520c7864">cryptonote::levin::connections</a></div><div class="ttdeci">epee::levin::async_protocol_handler_config&lt; detail::p2p_context &gt; connections</div><div class="ttdef"><b>Definition:</b> levin_notify.h:66</div></div>
<div class="ttc" id="minissdp_8c_html_a0873421d8da2b839db63d6f61cb10d16"><div class="ttname"><a href="../../de/dc6/minissdp_8c.html#a0873421d8da2b839db63d6f61cb10d16">uuid</a></div><div class="ttdeci">const char * uuid</div><div class="ttdef"><b>Definition:</b> minissdp.c:598</div></div>
<div class="ttc" id="stdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="../../df/dd8/stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> stdint.h:126</div></div>
<div class="ttc" id="syncobj_8h_html_adfcc7bf6d03ea34dbc9692a115c53da2"><div class="ttname"><a href="../../d6/ded/syncobj_8h.html#adfcc7bf6d03ea34dbc9692a115c53da2">CRITICAL_REGION_BEGIN</a></div><div class="ttdeci">#define CRITICAL_REGION_BEGIN(x)</div><div class="ttdef"><b>Definition:</b> syncobj.h:154</div></div>
<div class="ttc" id="levin__base_8h_html_aa34805f1cc19431602149596f1dad61a"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#aa34805f1cc19431602149596f1dad61a">LEVIN_PACKET_BEGIN</a></div><div class="ttdeci">#define LEVIN_PACKET_BEGIN</div><div class="ttdef"><b>Definition:</b> levin_base.h:81</div></div>
<div class="ttc" id="structepee_1_1levin_1_1levin__commands__handler_html"><div class="ttname"><a href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html">epee::levin::levin_commands_handler</a></div><div class="ttdef"><b>Definition:</b> levin_base.h:90</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a2f8f009eb31de9696fcb23d47007b23b"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a2f8f009eb31de9696fcb23d47007b23b">epee::levin::async_protocol_handler::async_invoke</a></div><div class="ttdeci">bool async_invoke(int command, message_writer in_msg, const callback_t &amp;cb, size_t timeout=LEVIN_DEFAULT_TIMEOUT_PRECONFIGURED)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:631</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_af53eb871f993cca1c157e80bac2e3b98"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#af53eb871f993cca1c157e80bac2e3b98">epee::levin::async_protocol_handler::get_context_ref</a></div><div class="ttdeci">t_connection_context &amp; get_context_ref()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:747</div></div>
<div class="ttc" id="namespaceepee_1_1misc__utils_html_a0b437906f4dc191bb47ae0d83739bc55"><div class="ttname"><a href="../../da/dcf/namespaceepee_1_1misc__utils.html#a0b437906f4dc191bb47ae0d83739bc55">epee::misc_utils::auto_scope_leave_caller</a></div><div class="ttdeci">boost::shared_ptr&lt; call_befor_die_base &gt; auto_scope_leave_caller</div><div class="ttdef"><b>Definition:</b> misc_language.h:80</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a87447e1e73f8d89c189bf428b7f9ac4f"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a87447e1e73f8d89c189bf428b7f9ac4f">epee::levin::async_protocol_handler_config::m_invoke_timeout</a></div><div class="ttdeci">uint64_t m_invoke_timeout</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:103</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a9052ea623aafad44b54bd0da107c7d2c"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a9052ea623aafad44b54bd0da107c7d2c">epee::levin::async_protocol_handler_config::close</a></div><div class="ttdeci">bool close(boost::uuids::uuid connection_id)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:930</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a64079d8a3784b04ff0ee7c1a36b6bcd8"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a64079d8a3784b04ff0ee7c1a36b6bcd8">epee::levin::async_protocol_handler_config::delete_connections</a></div><div class="ttdeci">void delete_connections(size_t count, bool incoming)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:760</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a4a41b55917e89104e2d65400b5849786"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a4a41b55917e89104e2d65400b5849786">epee::levin::async_protocol_handler_config::foreach_connection</a></div><div class="ttdeci">bool foreach_connection(const callback_t &amp;cb)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:847</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a95a9ebf87aa9760c503fc607f24f88b6"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a95a9ebf87aa9760c503fc607f24f88b6">epee::levin::async_protocol_handler_config::del_in_connections</a></div><div class="ttdeci">void del_in_connections(size_t count)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:797</div></div>
<div class="ttc" id="levin__base_8h_html_a38297b0714311bedc4a443077d5f5edc"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#a38297b0714311bedc4a443077d5f5edc">LEVIN_PACKET_END</a></div><div class="ttdeci">#define LEVIN_PACKET_END</div><div class="ttdef"><b>Definition:</b> levin_base.h:82</div></div>
<div class="ttc" id="classepee_1_1net__utils_1_1buffer_html_aa77da0ab67d8411f7e64c2f79a5cf3ec"><div class="ttname"><a href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#aa77da0ab67d8411f7e64c2f79a5cf3ec">epee::net_utils::buffer::carve</a></div><div class="ttdeci">epee::span&lt; const uint8_t &gt; carve(size_t sz)</div><div class="ttdef"><b>Definition:</b> buffer.h:55</div></div>
<div class="ttc" id="misc__language_8h_html"><div class="ttname"><a href="../../d1/dfc/misc__language_8h.html">misc_language.h</a></div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a1a7f0bc95c8394122fb29c5fa66ddb9e"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a1a7f0bc95c8394122fb29c5fa66ddb9e">epee::levin::async_protocol_handler::m_fragment_buffer</a></div><div class="ttdeci">std::string m_fragment_buffer</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:136</div></div>
<div class="ttc" id="stdint_8h_html_aec6fcb673ff035718c238c8c9d544c47"><div class="ttname"><a href="../../df/dd8/stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></div><div class="ttdeci">unsigned __int64 uint64_t</div><div class="ttdef"><b>Definition:</b> stdint.h:136</div></div>
<div class="ttc" id="classepee_1_1byte__slice_html"><div class="ttname"><a href="../../d0/d9e/classepee_1_1byte__slice.html">epee::byte_slice</a></div><div class="ttdef"><b>Definition:</b> byte_slice.h:68</div></div>
<div class="ttc" id="syncobj_8h_html_a92595a7293f6a3ed344a1b4c15e7fd2a"><div class="ttname"><a href="../../d6/ded/syncobj_8h.html#a92595a7293f6a3ed344a1b4c15e7fd2a">CRITICAL_REGION_LOCAL</a></div><div class="ttdeci">#define CRITICAL_REGION_LOCAL(x)</div><div class="ttdef"><b>Definition:</b> syncobj.h:153</div></div>
<div class="ttc" id="namespacenet_1_1zmq_html_ae9be1d22949d32a6c7883ae5945978a1"><div class="ttname"><a href="../../de/db0/namespacenet_1_1zmq.html#ae9be1d22949d32a6c7883ae5945978a1">net::zmq::context</a></div><div class="ttdeci">std::unique_ptr&lt; void, terminate &gt; context</div><div class="ttdoc">Unique ZMQ context handle, calls zmq_term on destruction. </div><div class="ttdef"><b>Definition:</b> zmq.h:105</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a81deb95abb05c9cecafabd662a4fe334"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a81deb95abb05c9cecafabd662a4fe334">epee::levin::async_protocol_handler_config::del_out_connections</a></div><div class="ttdeci">void del_out_connections(size_t count)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:791</div></div>
<div class="ttc" id="classepee_1_1net__utils_1_1buffer_html"><div class="ttname"><a href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html">epee::net_utils::buffer</a></div><div class="ttdef"><b>Definition:</b> buffer.h:46</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_a53e4490cedbf202dd990c6d2b787e31d"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a53e4490cedbf202dd990c6d2b787e31d">epee::levin::async_protocol_handler::anvoke_handler::m_cb</a></div><div class="ttdeci">callback_t m_cb</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:225</div></div>
<div class="ttc" id="stdbool_8h_html_a65e9886d74aaee76545e83dd09011727"><div class="ttname"><a href="../../d9/d5e/stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a></div><div class="ttdeci">#define false</div><div class="ttdef"><b>Definition:</b> stdbool.h:37</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a0553b5503145b64ea12141b3f01d18fb"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a0553b5503145b64ea12141b3f01d18fb">epee::levin::async_protocol_handler_config::async_protocol_handler_config</a></div><div class="ttdeci">async_protocol_handler_config()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:122</div></div>
<div class="ttc" id="classepee_1_1levin_1_1message__writer_html_a1e7a5b4f176bf0fa58a688d16eab11ba"><div class="ttname"><a href="../../dc/d26/classepee_1_1levin_1_1message__writer.html#a1e7a5b4f176bf0fa58a688d16eab11ba">epee::levin::message_writer::finalize_invoke</a></div><div class="ttdeci">byte_slice finalize_invoke(uint32_t command)</div><div class="ttdef"><b>Definition:</b> levin_base.h:151</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_aeab87b0a2a3b936e5aa2d3860544715b"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#aeab87b0a2a3b936e5aa2d3860544715b">epee::levin::async_protocol_handler_config::get_in_connections_count</a></div><div class="ttdeci">size_t get_in_connections_count()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:902</div></div>
<div class="ttc" id="structepee_1_1net__utils_1_1i__service__endpoint_html_ad2655ea4cb2f0dc05992ba60a86f76d6"><div class="ttname"><a href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#ad2655ea4cb2f0dc05992ba60a86f76d6">epee::net_utils::i_service_endpoint::close</a></div><div class="ttdeci">virtual bool close()=0</div></div>
<div class="ttc" id="namespaceepee_1_1misc__utils_html_a66aec447ca7af52caf4a49e8d2e5d560"><div class="ttname"><a href="../../da/dcf/namespaceepee_1_1misc__utils.html#a66aec447ca7af52caf4a49e8d2e5d560">epee::misc_utils::sleep_no_w</a></div><div class="ttdeci">bool sleep_no_w(long ms)</div><div class="ttdef"><b>Definition:</b> misc_language.cpp:35</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_adf1a6f746e63d0f007a84bcc7ab2f205"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#adf1a6f746e63d0f007a84bcc7ab2f205">epee::levin::async_protocol_handler_config::m_connects</a></div><div class="ttdeci">connections_map m_connects</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:84</div></div>
<div class="ttc" id="slow__memmem_8cpp_html_ae92da6cbed6002407731bd51f7c6b984"><div class="ttname"><a href="../../dc/d35/slow__memmem_8cpp.html#ae92da6cbed6002407731bd51f7c6b984">buf</a></div><div class="ttdeci">const char * buf</div><div class="ttdef"><b>Definition:</b> slow_memmem.cpp:73</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a629f66cdbe5ed91a3cc32762d81ea623"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a629f66cdbe5ed91a3cc32762d81ea623">epee::levin::async_protocol_handler::~async_protocol_handler</a></div><div class="ttdeci">virtual ~async_protocol_handler()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:324</div></div>
<div class="ttc" id="classepee_1_1critical__region__t_html_a3ed2a784463c21759e000d88a5713df5"><div class="ttname"><a href="../../da/d04/classepee_1_1critical__region__t.html#a3ed2a784463c21759e000d88a5713df5">epee::critical_region_t::unlock</a></div><div class="ttdeci">void unlock()</div><div class="ttdef"><b>Definition:</b> syncobj.h:142</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a7d8a38d11e362e84273c9b8cfd2d3a7d"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a7d8a38d11e362e84273c9b8cfd2d3a7d">epee::levin::async_protocol_handler::m_invoke_buf_ready</a></div><div class="ttdeci">std::atomic&lt; bool &gt; m_invoke_buf_ready</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:168</div></div>
<div class="ttc" id="int-util_8h_html"><div class="ttname"><a href="../../d5/d78/int-util_8h.html">int-util.h</a></div></div>
<div class="ttc" id="net__utils__base_8h_html_aaaf68851f429aeac8c9638ec082e8d7e"><div class="ttname"><a href="../../de/de6/net__utils__base_8h.html#aaaf68851f429aeac8c9638ec082e8d7e">LOG_ERROR_CC</a></div><div class="ttdeci">#define LOG_ERROR_CC(ct, message)</div><div class="ttdef"><b>Definition:</b> net_utils_base.h:467</div></div>
<div class="ttc" id="structepee_1_1levin_1_1bucket__head2_html_a02cdc680aaad26c3f22b9ecee6312721"><div class="ttname"><a href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#a02cdc680aaad26c3f22b9ecee6312721">epee::levin::bucket_head2::m_command</a></div><div class="ttdeci">uint32_t m_command</div><div class="ttdef"><b>Definition:</b> levin_base.h:67</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a3467939ab1ad5d10ae4bbfdc81c12f72"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a3467939ab1ad5d10ae4bbfdc81c12f72">epee::levin::async_protocol_handler::release_protocol</a></div><div class="ttdeci">bool release_protocol()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:365</div></div>
<div class="ttc" id="namespacetestupnpigd_html_a2555af319ee046c7951ea9d78eb57724"><div class="ttname"><a href="../../d2/d2c/namespacetestupnpigd.html#a2555af319ee046c7951ea9d78eb57724">testupnpigd.r</a></div><div class="ttdeci">r</div><div class="ttdef"><b>Definition:</b> testupnpigd.py:61</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a2aefffdba133dc76afbe098d67e0aa65"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a2aefffdba133dc76afbe098d67e0aa65">epee::levin::async_protocol_handler_config::find_connection</a></div><div class="ttdeci">async_protocol_handler&lt; t_connection_context &gt; * find_connection(boost::uuids::uuid connection_id) const</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:812</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_acbbb8de2208d86d282441ec01932cab5"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#acbbb8de2208d86d282441ec01932cab5">epee::levin::async_protocol_handler_config::del_connection</a></div><div class="ttdeci">void del_connection(async_protocol_handler&lt; t_connection_context &gt; *pc)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:751</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_abcee686a6e07280a830f6e51b2048af6"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abcee686a6e07280a830f6e51b2048af6">epee::levin::async_protocol_handler::get_connection_id</a></div><div class="ttdeci">boost::uuids::uuid get_connection_id()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:745</div></div>
<div class="ttc" id="namespaceepee_html"><div class="ttname"><a href="../../df/dc7/namespaceepee.html">epee</a></div><div class="ttdoc">TODO: (mj-xmr) This will be reduced in an another PR. </div><div class="ttdef"><b>Definition:</b> byte_slice.h:39</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a54e7914a95003c077f8db3294f88a6bc"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a54e7914a95003c077f8db3294f88a6bc">epee::levin::async_protocol_handler::handle_recv</a></div><div class="ttdeci">virtual bool handle_recv(const void *ptr, size_t cb)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:408</div></div>
<div class="ttc" id="structepee_1_1net__utils_1_1i__service__endpoint_html"><div class="ttname"><a href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html">epee::net_utils::i_service_endpoint</a></div><div class="ttdef"><b>Definition:</b> net_utils_base.h:439</div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_aa1114d84589bd22f45d443527528cb35"><div class="ttname"><a href="../../d0/da7/namespacetesting_1_1internal.html#aa1114d84589bd22f45d443527528cb35">testing::internal::move</a></div><div class="ttdeci">const T &amp; move(const T &amp;t)</div><div class="ttdef"><b>Definition:</b> gtest-port.h:1317</div></div>
<div class="ttc" id="buffer_8h_html"><div class="ttname"><a href="../../d5/d08/buffer_8h.html">buffer.h</a></div></div>
<div class="ttc" id="levin__base_8h_html_a1d9eddb66c14d27facb30fafdbca6eb0"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#a1d9eddb66c14d27facb30fafdbca6eb0">LEVIN_ERROR_CONNECTION</a></div><div class="ttdeci">#define LEVIN_ERROR_CONNECTION</div><div class="ttdef"><b>Definition:</b> levin_base.h:103</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_ac089e912a905e37b466a2af35ebefeac"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ac089e912a905e37b466a2af35ebefeac">epee::levin::async_protocol_handler::m_current_head</a></div><div class="ttdeci">bucket_head2 m_current_head</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:179</div></div>
<div class="ttc" id="int-util_8h_html_a37afc8350a3a9f9744410844aaef518c"><div class="ttname"><a href="../../d5/d78/int-util_8h.html#a37afc8350a3a9f9744410844aaef518c">SWAP64LE</a></div><div class="ttdeci">#define SWAP64LE</div><div class="ttdef"><b>Definition:</b> int-util.h:313</div></div>
<div class="ttc" id="glibc__compat_8cpp_html_a0f46826ab0466591e136db24394923cf"><div class="ttname"><a href="../../d5/d9f/glibc__compat_8cpp.html#a0f46826ab0466591e136db24394923cf">memcpy</a></div><div class="ttdeci">void * memcpy(void *a, const void *b, size_t c)</div><div class="ttdef"><b>Definition:</b> glibc_compat.cpp:16</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a8fcaff270713d22805656eeb49b859b1"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8fcaff270713d22805656eeb49b859b1">epee::levin::async_protocol_handler_config::add_connection</a></div><div class="ttdeci">void add_connection(async_protocol_handler&lt; t_connection_context &gt; *pc)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:803</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_abd4b6a50ce3a6f1a2a7f4e43ceb41889"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#abd4b6a50ce3a6f1a2a7f4e43ceb41889">epee::levin::async_protocol_handler::m_invoke_result_code</a></div><div class="ttdeci">volatile int m_invoke_result_code</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:170</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html">epee::levin::async_protocol_handler</a></div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:77</div></div>
<div class="ttc" id="structepee_1_1net__utils_1_1i__service__endpoint_html_a5d90af9574b91f3e1f2ea90077ffea7e"><div class="ttname"><a href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#a5d90af9574b91f3e1f2ea90077ffea7e">epee::net_utils::i_service_endpoint::call_run_once_service_io</a></div><div class="ttdeci">virtual bool call_run_once_service_io()=0</div></div>
<div class="ttc" id="classepee_1_1critical__region__t_html"><div class="ttname"><a href="../../da/d04/classepee_1_1critical__region__t.html">epee::critical_region_t</a></div><div class="ttdef"><b>Definition:</b> syncobj.h:124</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html">epee::levin::async_protocol_handler_config</a></div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:80</div></div>
<div class="ttc" id="classepee_1_1net__utils_1_1buffer_html_adfce826deb76f4b0f7e022e764582572"><div class="ttname"><a href="../../d6/d8a/classepee_1_1net__utils_1_1buffer.html#adfce826deb76f4b0f7e022e764582572">epee::net_utils::buffer::span</a></div><div class="ttdeci">epee::span&lt; const uint8_t &gt; span(size_t sz) const</div><div class="ttdef"><b>Definition:</b> buffer.h:53</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a533976eb424aff6ac1002cb39b87033d"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a533976eb424aff6ac1002cb39b87033d">epee::levin::async_protocol_handler::update_connection_context</a></div><div class="ttdeci">void update_connection_context(const connection_context &amp;contxt)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:390</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_ad7bb4fe9382564d5212bceb0b107d487"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad7bb4fe9382564d5212bceb0b107d487">epee::levin::async_protocol_handler::invoke</a></div><div class="ttdeci">int invoke(int command, message_writer in_msg, std::string &amp;buff_out)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:676</div></div>
<div class="ttc" id="levin__base_8h_html_a12433b8e4e6da9a447ed609690450fe3"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#a12433b8e4e6da9a447ed609690450fe3">LEVIN_PROTOCOL_VER_1</a></div><div class="ttdeci">#define LEVIN_PROTOCOL_VER_1</div><div class="ttdef"><b>Definition:</b> levin_base.h:86</div></div>
<div class="ttc" id="structepee_1_1levin_1_1levin__commands__handler_html_a32a8bfeff79c63a0defc76acc345bac3"><div class="ttname"><a href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html#a32a8bfeff79c63a0defc76acc345bac3">epee::levin::levin_commands_handler::on_connection_new</a></div><div class="ttdeci">virtual void on_connection_new(t_connection_context &amp;context)</div><div class="ttdef"><b>Definition:</b> levin_base.h:96</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a8798dd25f119812f631a56366a4c2f3e"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a8798dd25f119812f631a56366a4c2f3e">epee::levin::async_protocol_handler_config::update_connection_context</a></div><div class="ttdeci">bool update_connection_context(const t_connection_context &amp;contxt)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:945</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html">epee::levin::async_protocol_handler::anvoke_handler</a></div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:200</div></div>
<div class="ttc" id="code-generator_8cpp_html_ad41ea26c8e549ce5fef3c9e5df078f05"><div class="ttname"><a href="../../da/d36/code-generator_8cpp.html#ad41ea26c8e549ce5fef3c9e5df078f05">seed</a></div><div class="ttdeci">const uint8_t seed[32]</div><div class="ttdef"><b>Definition:</b> code-generator.cpp:37</div></div>
<div class="ttc" id="levin__base_8h_html_a9497e6e3132b6c55af7c4b2fc58c8554"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#a9497e6e3132b6c55af7c4b2fc58c8554">LEVIN_ERROR_CONNECTION_DESTROYED</a></div><div class="ttdeci">#define LEVIN_ERROR_CONNECTION_DESTROYED</div><div class="ttdef"><b>Definition:</b> levin_base.h:105</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a83046603800352cae8978c26b4f823c9"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a83046603800352cae8978c26b4f823c9">epee::levin::async_protocol_handler_config::set_handler</a></div><div class="ttdeci">void set_handler(levin_commands_handler&lt; t_connection_context &gt; *handler, void(*destroy)(levin_commands_handler&lt; t_connection_context &gt; *)=NULL)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:913</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a90748de7854397764729518eaef396b5"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a90748de7854397764729518eaef396b5">epee::levin::async_protocol_handler::m_state</a></div><div class="ttdeci">stream_state m_state</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:186</div></div>
<div class="ttc" id="structepee_1_1net__utils_1_1i__service__endpoint_html_a2772195d6f8fac200406254737d95a22"><div class="ttname"><a href="../../de/db7/structepee_1_1net__utils_1_1i__service__endpoint.html#a2772195d6f8fac200406254737d95a22">epee::net_utils::i_service_endpoint::request_callback</a></div><div class="ttdeci">virtual bool request_callback()=0</div></div>
<div class="ttc" id="classepee_1_1levin_1_1message__writer_html_af22cb9d621ac925792ccad1113754dcc"><div class="ttname"><a href="../../dc/d26/classepee_1_1levin_1_1message__writer.html#af22cb9d621ac925792ccad1113754dcc">epee::levin::message_writer::header</a></div><div class="ttdeci">bucket_head2 header</div><div class="ttdef"><b>Definition:</b> levin_base.h:135</div></div>
<div class="ttc" id="classepee_1_1byte__slice_html_ae0eeb6f797cdaf8f7024ff60f9976fe8"><div class="ttname"><a href="../../d0/d9e/classepee_1_1byte__slice.html#ae0eeb6f797cdaf8f7024ff60f9976fe8">epee::byte_slice::data</a></div><div class="ttdeci">const std::uint8_t * data() const noexcept</div><div class="ttdef"><b>Definition:</b> byte_slice.h:133</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_ad4dcef43a03f7f574691a4d6c7478393"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#ad4dcef43a03f7f574691a4d6c7478393">epee::levin::async_protocol_handler::finish_outer_call</a></div><div class="ttdeci">bool finish_outer_call()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:357</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a02eeca929b3df5602f3178c5b7e23bd0"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a02eeca929b3df5602f3178c5b7e23bd0">epee::levin::async_protocol_handler::handle_qued_callback</a></div><div class="ttdeci">void handle_qued_callback()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:403</div></div>
<div class="ttc" id="stdint_8h_html_ab1967d8591af1a4e48c37fd2b0f184d0"><div class="ttname"><a href="../../df/dd8/stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a></div><div class="ttdeci">signed int int32_t</div><div class="ttdef"><b>Definition:</b> stdint.h:123</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_ab6a6a1e55430ced4eedf18922b177333"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#ab6a6a1e55430ced4eedf18922b177333">epee::levin::async_protocol_handler::anvoke_handler::cancel_timer</a></div><div class="ttdeci">virtual bool cancel_timer()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:254</div></div>
<div class="ttc" id="levin__base_8h_html_adc3c0671eb36e04ca369816c36f21a1b"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#adc3c0671eb36e04ca369816c36f21a1b">LEVIN_DEFAULT_TIMEOUT_PRECONFIGURED</a></div><div class="ttdeci">#define LEVIN_DEFAULT_TIMEOUT_PRECONFIGURED</div><div class="ttdef"><b>Definition:</b> levin_base.h:75</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_ada987f3850cb6b6727a2d3125fa19bdb"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#ada987f3850cb6b6727a2d3125fa19bdb">epee::levin::async_protocol_handler::anvoke_handler::m_timer_cancelled</a></div><div class="ttdeci">bool m_timer_cancelled</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:230</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a1bb966d6e3aff44a4eb0158b24afc2f1"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a1bb966d6e3aff44a4eb0158b24afc2f1">epee::levin::async_protocol_handler::m_oponent_protocol_ver</a></div><div class="ttdeci">int32_t m_oponent_protocol_ver</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:188</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a10ad1f1876109b35e117de5e94479725"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a10ad1f1876109b35e117de5e94479725">epee::levin::async_protocol_handler::m_call_lock</a></div><div class="ttdeci">critical_section m_call_lock</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:175</div></div>
<div class="ttc" id="namespacelmdb_html_a9cb8ade56f7bb8b0f875602bede7cd3e"><div class="ttname"><a href="../../df/d88/namespacelmdb.html#a9cb8ade56f7bb8b0f875602bede7cd3e">lmdb::error</a></div><div class="ttdeci">error</div><div class="ttdoc">Tracks LMDB error codes. </div><div class="ttdef"><b>Definition:</b> error.h:44</div></div>
<div class="ttc" id="namespacegtest__output__test_html_ac696d0798ad7d08cb2e61070824750e2"><div class="ttname"><a href="../../d6/dc2/namespacegtest__output__test.html#ac696d0798ad7d08cb2e61070824750e2">gtest_output_test.message</a></div><div class="ttdeci">tuple message</div><div class="ttdef"><b>Definition:</b> gtest_output_test.py:331</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_a4d1b094c35df709f464ea2d50120ad64"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a4d1b094c35df709f464ea2d50120ad64">epee::levin::async_protocol_handler::anvoke_handler::m_con</a></div><div class="ttdeci">async_protocol_handler &amp; m_con</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:226</div></div>
<div class="ttc" id="structepee_1_1levin_1_1bucket__head2_html_af8ce8d9bfa19fe65939b7dd68c8ec906"><div class="ttname"><a href="../../dd/df0/structepee_1_1levin_1_1bucket__head2.html#af8ce8d9bfa19fe65939b7dd68c8ec906">epee::levin::bucket_head2::m_have_to_return_data</a></div><div class="ttdeci">uint8_t m_have_to_return_data</div><div class="ttdef"><b>Definition:</b> levin_base.h:66</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a61ee2b210b302fd0453a6842b76cf130"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a61ee2b210b302fd0453a6842b76cf130">epee::levin::async_protocol_handler::send</a></div><div class="ttdeci">int send(byte_slice message)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:731</div></div>
<div class="ttc" id="fuzz_2levin_8cpp_html_a5792c2d0c3d746ccfd5f938436c42951"><div class="ttname"><a href="../../df/dd9/fuzz_2levin_8cpp.html#a5792c2d0c3d746ccfd5f938436c42951">conn</a></div><div class="ttdeci">std::unique_ptr&lt; test_connection &gt; conn(new test_connection(io_service, m_handler_config))</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a4046568fefb64f4ef1ee07d7c86f573c"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a4046568fefb64f4ef1ee07d7c86f573c">epee::levin::async_protocol_handler_config::for_connection</a></div><div class="ttdeci">bool for_connection(const boost::uuids::uuid &amp;connection_id, const callback_t &amp;cb)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:871</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_a8444d751fa2b3910096d7e880b6a8d9d"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a8444d751fa2b3910096d7e880b6a8d9d">epee::levin::async_protocol_handler::anvoke_handler::~anvoke_handler</a></div><div class="ttdeci">virtual ~anvoke_handler()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:223</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_af4b74b0d1ed643e9f252dab768b54c65"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#af4b74b0d1ed643e9f252dab768b54c65">epee::levin::async_protocol_handler::anvoke_handler::m_cancel_timer_called</a></div><div class="ttdeci">bool m_cancel_timer_called</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:229</div></div>
<div class="ttc" id="int-util_8h_html_a51aa478627a7a7a2c63a84d838f95306"><div class="ttname"><a href="../../d5/d78/int-util_8h.html#a51aa478627a7a7a2c63a84d838f95306">SWAP32LE</a></div><div class="ttdeci">#define SWAP32LE</div><div class="ttdef"><b>Definition:</b> int-util.h:305</div></div>
<div class="ttc" id="structepee_1_1levin_1_1levin__commands__handler_html_a5d3cd8de621eb54af73e8871af47441c"><div class="ttname"><a href="../../d0/d38/structepee_1_1levin_1_1levin__commands__handler.html#a5d3cd8de621eb54af73e8871af47441c">epee::levin::levin_commands_handler::on_connection_close</a></div><div class="ttdeci">virtual void on_connection_close(t_connection_context &amp;context)</div><div class="ttdef"><b>Definition:</b> levin_base.h:97</div></div>
<div class="ttc" id="levin__base_8h_html_a709ab2a492052555f3631cf5d5d4761e"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#a709ab2a492052555f3631cf5d5d4761e">LEVIN_OK</a></div><div class="ttdeci">#define LEVIN_OK</div><div class="ttdef"><b>Definition:</b> levin_base.h:102</div></div>
<div class="ttc" id="namespacepymoduletest_html_a2bce00014695ec26226c92abd4eccb9a"><div class="ttname"><a href="../../d5/dd5/namespacepymoduletest.html#a2bce00014695ec26226c92abd4eccb9a">pymoduletest.c</a></div><div class="ttdeci">c</div><div class="ttdef"><b>Definition:</b> pymoduletest.py:79</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_afa8f16259970e349d53c1ba8b7f42efb"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#afa8f16259970e349d53c1ba8b7f42efb">epee::levin::async_protocol_handler::anvoke_handler::reset_timer</a></div><div class="ttdeci">virtual void reset_timer()</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:264</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_aed134afb5690dfb39642e7fc6a36bcaa"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#aed134afb5690dfb39642e7fc6a36bcaa">epee::levin::async_protocol_handler_config::m_initial_max_packet_size</a></div><div class="ttdeci">uint64_t m_initial_max_packet_size</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:101</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler__config_html_a343a368e7a9b7ff8bdebd713b45bbef0"><div class="ttname"><a href="../../d6/dcc/classepee_1_1levin_1_1async__protocol__handler__config.html#a343a368e7a9b7ff8bdebd713b45bbef0">epee::levin::async_protocol_handler_config::m_pcommands_handler_destroy</a></div><div class="ttdeci">void(* m_pcommands_handler_destroy)(levin_commands_handler&lt; t_connection_context &gt; *)</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:95</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler_html_a6f155286cc92689928ae3544546328d2"><div class="ttname"><a href="../../da/dbc/structepee_1_1levin_1_1async__protocol__handler_1_1anvoke__handler.html#a6f155286cc92689928ae3544546328d2">epee::levin::async_protocol_handler::anvoke_handler::m_timer</a></div><div class="ttdeci">boost::asio::deadline_timer m_timer</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:227</div></div>
<div class="ttc" id="structepee_1_1levin_1_1async__protocol__handler_1_1invoke__response__handler__base_html"><div class="ttname"><a href="../../d2/dbd/structepee_1_1levin_1_1async__protocol__handler_1_1invoke__response__handler__base.html">epee::levin::async_protocol_handler::invoke_response_handler_base</a></div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:191</div></div>
<div class="ttc" id="levin__base_8h_html_a34200c1790d28e01ac6d782ff70d9543"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#a34200c1790d28e01ac6d782ff70d9543">LEVIN_INITIAL_MAX_PACKET_SIZE</a></div><div class="ttdeci">#define LEVIN_INITIAL_MAX_PACKET_SIZE</div><div class="ttdef"><b>Definition:</b> levin_base.h:76</div></div>
<div class="ttc" id="classepee_1_1levin_1_1async__protocol__handler_html_a55c5aaba60e0e74af1b82246af0bf8d1"><div class="ttname"><a href="../../d0/dea/classepee_1_1levin_1_1async__protocol__handler.html#a55c5aaba60e0e74af1b82246af0bf8d1">epee::levin::async_protocol_handler::connection_context</a></div><div class="ttdeci">t_connection_context connection_context</div><div class="ttdef"><b>Definition:</b> levin_protocol_handler_async.h:158</div></div>
<div class="ttc" id="levin__base_8h_html_aa78a724b29fdb403463e461d1e0d89c2"><div class="ttname"><a href="../../d2/da4/levin__base_8h.html#aa78a724b29fdb403463e461d1e0d89c2">LEVIN_ERROR_CONNECTION_NOT_FOUND</a></div><div class="ttdeci">#define LEVIN_ERROR_CONNECTION_NOT_FOUND</div><div class="ttdef"><b>Definition:</b> levin_base.h:104</div></div>
<div class="ttc" id="signature_8cpp_html_a9200197b9c765b5e63983faaf4d96cf4"><div class="ttname"><a href="../../d0/d74/signature_8cpp.html#a9200197b9c765b5e63983faaf4d96cf4">if</a></div><div class="ttdeci">if(!cryptonote::get_account_address_from_str_or_url(info, cryptonote::TESTNET, &quot;9uVsvEryzpN8WH2t1WWhFFCG5tS8cBNdmJYNRuckLENFimfauV5pZKeS1P2CbxGkSDTUPHXWwiYE5ZGSXDAGbaZgDxobqDN&quot;))</div><div class="ttdef"><b>Definition:</b> signature.cpp:53</div></div>
<div class="ttc" id="classepee_1_1span_html_af9959653eb0d2f90fefd449016b9e8c2"><div class="ttname"><a href="../../d0/d87/classepee_1_1span.html#af9959653eb0d2f90fefd449016b9e8c2">epee::span::data</a></div><div class="ttdeci">constexpr pointer data() const noexcept</div><div class="ttdef"><b>Definition:</b> span.h:108</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Sep 2 2023 19:23:19 for Monero by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
