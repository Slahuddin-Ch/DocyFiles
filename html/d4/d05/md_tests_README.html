<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Monero: Running all tests</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Monero
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Running all tests </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To run all tests, run:</p>
<div class="fragment"><div class="line">cd /path/to/monero</div><div class="line">make [-jn] debug-test # where n is number of compiler processes</div></div><!-- fragment --><p>To test a release build, replace <code>debug-test</code> with <code>release-test</code> in the previous command.</p>
<h1>Core tests</h1>
<p>Core tests take longer than any other <a class="el" href="../../d1/d5b/namespaceMonero.html">Monero</a> tests, due to the high amount of computational work involved in validating core components.</p>
<p>Tests are located in <code>tests/core_tests/</code>, and follow a straightforward naming convention. Most cases cover core functionality (<code>block_reward.cpp</code>, <code><a class="el" href="../../d3/dd8/chaingen_8cpp.html">chaingen.cpp</a></code>, <code><a class="el" href="../../de/da8/rct_8cpp.html">rct.cpp</a></code>, etc.), while some cover basic security tests (<code><a class="el" href="../../d0/d73/double__spend_8cpp.html">double_spend.cpp</a></code> &amp; <code><a class="el" href="../../d6/de5/integer__overflow_8cpp.html">integer_overflow.cpp</a></code>).</p>
<p>To run only <a class="el" href="../../d1/d5b/namespaceMonero.html">Monero</a>'s core tests (after building):</p>
<div class="fragment"><div class="line">cd build/debug/tests/core_tests</div><div class="line">ctest</div></div><!-- fragment --><p>To run the same tests on a release build, replace <code>debug</code> with <code>release</code>.</p>
<h1>Crypto Tests</h1>
<p>Crypto tests are located under the <code>tests/crypto</code> directory.</p>
<ul>
<li><code>crypto-tests.h</code> contains test harness headers</li>
<li><code>main.cpp</code> implements the driver for the crypto tests</li>
</ul>
<p>Tests correspond to components under <code>src/crypto/</code>. A quick comparison reveals the pattern, and new tests should continue the naming convention.</p>
<p>To run only <a class="el" href="../../d1/d5b/namespaceMonero.html">Monero</a>'s crypto tests (after building):</p>
<div class="fragment"><div class="line">cd build/debug/tests/crypto</div><div class="line">ctest</div></div><!-- fragment --><p>To run the same tests on a release build, replace <code>debug</code> with <code>release</code>.</p>
<h1>Daemon tests</h1>
<p>[TODO]</p>
<h1>Functional tests</h1>
<p>[TODO] Functional tests are located under the <code>tests/functional_tests</code> directory.</p>
<p>Building all the tests requires installing the following dependencies: </p><div class="fragment"><div class="line">pip install requests psutil monotonic zmq deepdiff</div></div><!-- fragment --><p>First, run a regtest daemon in the offline mode and with a fixed difficulty: </p><div class="fragment"><div class="line">monerod --regtest --offline --fixed-difficulty 1</div></div><!-- fragment --><p> Alternatively, you can run multiple daemons and let them connect with each other by using <code>--add-exclusive-node</code>. In this case, make sure that the same fixed difficulty is given to all the daemons.</p>
<p>Next, restore a mainnet wallet with the following seed and restore height 0 (the file path doesn't matter): </p><div class="fragment"><div class="line">velvet lymph giddy number token physics poetry unquoted nibs useful sabotage limits benches lifestyle eden nitrogen anvil fewest avoid batch vials washing fences goat unquoted</div></div><!-- fragment --><p>Open the wallet file with <code>monero-wallet-rpc</code> with RPC port 18083. Finally, start tests by invoking ./blockchain.py or ./speed.py</p>
<h2>Parameters</h2>
<p>Configuration of individual tests.</p>
<h3>Mining test</h3>
<p>The following environment variables may be set to control the mining test:</p>
<ul>
<li><code>MINING_NO_MEASUREMENT</code> - set to anything to use large enough and fixed mining timeouts (use case: very slow PCs and no intention to change the mining code)</li>
<li><code>MINING_SILENT</code> - set to anything to disable mining logging</li>
</ul>
<p>For example, to customize the run of the functional tests, you may run the following commands from the build directory:</p>
<div class="fragment"><div class="line">export MINING_NO_MEASUREMENT=1</div><div class="line">ctest -V -R functional_tests_rpc</div><div class="line">unset MINING_NO_MEASUREMENT</div></div><!-- fragment --><h1>Fuzz tests</h1>
<p>Fuzz tests are written using American Fuzzy Lop (AFL), and located under the <code>tests/fuzz</code> directory.</p>
<p>An additional helper utility is provided <code>contrib/fuzz_testing/fuzz.sh</code>. AFL must be installed, and some additional setup may be necessary for the script to run properly.</p>
<h1>Hash tests</h1>
<p>Hash tests exist under <code>tests/hash</code>, and include a set of target hashes in text files.</p>
<p>To run only <a class="el" href="../../d1/d5b/namespaceMonero.html">Monero</a>'s hash tests (after building):</p>
<div class="fragment"><div class="line">cd build/debug/tests/hash</div><div class="line">ctest</div></div><!-- fragment --><p>To run the same tests on a release build, replace <code>debug</code> with <code>release</code>.</p>
<h1>Libwallet API tests</h1>
<p>[TODO]</p>
<h1>Net Load tests</h1>
<p>[TODO]</p>
<h1>Performance tests</h1>
<p>Performance tests are located in <code>tests/performance_tests</code>, and test features for performance metrics on the host machine.</p>
<p>To run only <a class="el" href="../../d1/d5b/namespaceMonero.html">Monero</a>'s performance tests (after building):</p>
<div class="fragment"><div class="line">cd build/debug/tests/performance_tests</div><div class="line">./performance_tests</div></div><!-- fragment --><p>The path may be build/Linux/master/debug (adapt as necessary for your platform).</p>
<p>If the <code>performance_tests</code> binary does not exist, try running <code>make</code> in the <code>build/debug/tests/performance_tests</code> directory.</p>
<p>To run the same tests on a release build, replace <code>debug</code> with <code>release</code>.</p>
<h1>Unit tests</h1>
<p>Unit tests are defined under the <code>tests/unit_tests</code> directory. Independent components are tested individually to ensure they work properly on their own.</p>
<p>To run only <a class="el" href="../../d1/d5b/namespaceMonero.html">Monero</a>'s unit tests (after building):</p>
<div class="fragment"><div class="line">cd build/debug/tests/unit_tests</div><div class="line">ctest</div></div><!-- fragment --><p>To run the same tests on a release build, replace <code>debug</code> with <code>release</code>.</p>
<h1>Writing new tests</h1>
<h2>Test hygiene</h2>
<p>When writing new tests, please implement all functions in <code>.cpp</code> or <code>.c</code> files, and only put function headers in <code>.h</code> files. This will help keep the fairly complex test suites somewhat sane going forward.</p>
<h2>Writing fuzz tests</h2>
<p>[TODO] </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Sep 2 2023 19:23:34 for Monero by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
